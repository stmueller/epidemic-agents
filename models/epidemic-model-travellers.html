<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Tauseef Ibn Mamun &amp; Shane T. Mueller" />

<meta name="date" content="2020-05-04" />

<title>Modeling psychological impacts on epidemic spread: the effect of vacationers on a network</title>

<script src="epidemic-model-travellers_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="epidemic-model-travellers_files/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
<script src="epidemic-model-travellers_files/bootstrap-3.3.7/js/bootstrap.min.js"></script>
<script src="epidemic-model-travellers_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<script src="epidemic-model-travellers_files/navigation-1.1/tabsets.js"></script>
<script src="epidemic-model-travellers_files/navigation-1.1/codefolding.js"></script>
<link href="epidemic-model-travellers_files/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
<script src="epidemic-model-travellers_files/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
<link href="epidemic-model-travellers_files/readthedown-0.1/readthedown.css" rel="stylesheet" />
<script src="epidemic-model-travellers_files/readthedown-0.1/readthedown.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span. { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>


</head>

<body>


<div id="content" data-toggle="wy-nav-shift">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("text-table-of-contents");
});
</script>

<!-- code folding -->

<nav id="nav-top" role="navigation" aria-label="top navigation">
    <a role="button" href="#" data-toggle="wy-nav-top"><span class="glyphicon glyphicon-menu-hamburger"></span></a>
</nav>


<div id="header">
<h1 class="title">Modeling psychological impacts on epidemic spread: the effect of vacationers on a network</h1>
</div>


<div id="sidebar">
    <h2><a href="#content">Modeling psychological impacts on epidemic spread: the effect of vacationers on a network</a></h2>
    <div id="table-of-contents">
      <ul>
      <li><a href="#modeling-the-effect-of-outside-travellers-on-epidemic-spread-in-an-agent-based-simulation">Modeling the effect of outside travellers on epidemic spread in an agent-based simulation</a><ul>
      <li><a href="#the-agent">The agent</a></li>
      <li><a href="#create-transition-matrix.">Create transition matrix.</a></li>
      <li><a href="#social-model">Social model</a></li>
      <li><a href="#adding-a-new-agent-to-the-network">Adding a new agent to the network</a></li>
      <li><a href="#background">Background</a></li>
      <li><a href="#travel-ban-lift-and-allowing-traveler-to-the-community">Travel ban lift and allowing traveler to the community</a></li>
      <li><a href="#initial-simulation">Initial simulation</a></li>
      <li><a href="#travel-ban">Travel ban</a></li>
      <li><a href="#travel-banearly-removal">Travel ban/early removal</a></li>
      <li><a href="#travel-banlate-removal">Travel ban/late removal</a></li>
      <li><a href="#second-simulation-series">Second simulation series</a></li>
      <li><a href="#if-no-traveler-is-allowed-and-some-locals-are-infected">IF no traveler is allowed and some locals are infected</a></li>
      <li><a href="#travel-ban-removed-early">Travel ban removed early</a></li>
      <li><a href="#travel-banremoved-late">Travel ban/removed late</a></li>
      </ul></li>
      </ul>
    </div>
    
    <div id="postamble" data-toggle="wy-nav-shift" class="status">
              <p class="author"><span class="glyphicon glyphicon-user"></span> Tauseef Ibn Mamun &amp; Shane T. Mueller</p>
                  <p class="date"><span class="glyphicon glyphicon-calendar"></span> May 4, 2020</p>
        </div>
</div>

<div id="main">
<div id="modeling-the-effect-of-outside-travellers-on-epidemic-spread-in-an-agent-based-simulation" class="section level1">
<h1>Modeling the effect of outside travellers on epidemic spread in an agent-based simulation</h1>
<p>This model is based on the model/simulation <a href="epidemic-model-base.html">found here</a>.</p>
<div id="the-agent" class="section level2">
<h2>The agent</h2>
<p>We will augment the agent with an additional state–not in network. This will let us have ‘vacationer’ or ‘traveller’ agents that leave the network and no longer impact anyone.</p>
<ol style="list-style-type: decimal">
<li>Unexposed</li>
<li>Asymptomatic but infected/contagious</li>
<li>Symptomatic and contagious</li>
<li>Symptomatic and not contagious</li>
<li>Post-COVID Immune</li>
<li>Naturally immune (will not contract)</li>
<li>Death</li>
<li>Left network</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(dplyr)</a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">library</span>(sna)</a></code></pre></div>
<pre><code>## Loading required package: statnet.common</code></pre>
<pre><code>## 
## Attaching package: &#39;statnet.common&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     order</code></pre>
<pre><code>## Loading required package: network</code></pre>
<pre><code>## network: Classes for Relational Data
## Version 1.16.0 created on 2019-11-30.
## copyright (c) 2005, Carter T. Butts, University of California-Irvine
##                     Mark S. Handcock, University of California -- Los Angeles
##                     David R. Hunter, Penn State University
##                     Martina Morris, University of Washington
##                     Skye Bender-deMoll, University of Washington
##  For citation information, type citation(&quot;network&quot;).
##  Type help(&quot;network-package&quot;) to get started.</code></pre>
<pre><code>## sna: Tools for Social Network Analysis
## Version 2.5 created on 2019-12-09.
## copyright (c) 2005, Carter T. Butts, University of California-Irvine
##  For citation information, type citation(&quot;sna&quot;).
##  Type help(package=&quot;sna&quot;) to get started.</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="kw">library</span>(reshape2)</a>
<a class="sourceLine" id="cb12-3" title="3"><span class="kw">library</span>(igraph)</a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;igraph&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:sna&#39;:
## 
##     betweenness, bonpow, closeness, components, degree, dyad.census,
##     evcent, hierarchy, is.connected, neighborhood, triad.census</code></pre>
<pre><code>## The following objects are masked from &#39;package:network&#39;:
## 
##     %c%, %s%, add.edges, add.vertices, delete.edges, delete.vertices,
##     get.edge.attribute, get.edges, get.vertex.attribute, is.bipartite,
##     is.directed, list.edge.attributes, list.vertex.attributes,
##     set.edge.attribute, set.vertex.attribute</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     as_data_frame, groups, union</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     decompose, spectrum</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     union</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">library</span>(GGally)</a></code></pre></div>
<pre><code>## Registered S3 method overwritten by &#39;GGally&#39;:
##   method from   
##   +.gg   ggplot2</code></pre>
<pre><code>## 
## Attaching package: &#39;GGally&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     nasa</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">library</span>(rlist)</a>
<a class="sourceLine" id="cb23-2" title="2"><span class="co">#library(animation)</span></a>
<a class="sourceLine" id="cb23-3" title="3"></a>
<a class="sourceLine" id="cb23-4" title="4">STATES &lt;&lt;-<span class="st"> </span><span class="dv">8</span></a>
<a class="sourceLine" id="cb23-5" title="5"></a>
<a class="sourceLine" id="cb23-6" title="6">STATENAMES &lt;&lt;-<span class="st">  </span><span class="kw">c</span>(<span class="st">&quot;Unexposed&quot;</span>,</a>
<a class="sourceLine" id="cb23-7" title="7">                  <span class="st">&quot;Asymptomatic &amp; contagious&quot;</span>,</a>
<a class="sourceLine" id="cb23-8" title="8"><span class="st">&quot;Symptomatic and contagious&quot;</span>,</a>
<a class="sourceLine" id="cb23-9" title="9"><span class="st">&quot;Symptomatic and not contagious&quot;</span>,</a>
<a class="sourceLine" id="cb23-10" title="10"><span class="st">&quot;Post-COVID immune&quot;</span>,</a>
<a class="sourceLine" id="cb23-11" title="11"><span class="st">&quot;Naturally immune&quot;</span>,</a>
<a class="sourceLine" id="cb23-12" title="12"><span class="st">&quot;Death&quot;</span>,</a>
<a class="sourceLine" id="cb23-13" title="13"><span class="st">&quot;Left&quot;</span>)</a>
<a class="sourceLine" id="cb23-14" title="14"></a>
<a class="sourceLine" id="cb23-15" title="15"></a>
<a class="sourceLine" id="cb23-16" title="16">STATELABELS &lt;&lt;-<span class="st">  </span><span class="kw">c</span>(<span class="st">&quot;Unexposed&quot;</span>,<span class="st">&quot;Asymptomatic</span><span class="ch">\n</span><span class="st"> &amp; contagious&quot;</span>,</a>
<a class="sourceLine" id="cb23-17" title="17"><span class="st">&quot;Symptomatic </span><span class="ch">\n</span><span class="st">&amp; contagious&quot;</span>,</a>
<a class="sourceLine" id="cb23-18" title="18"><span class="st">&quot;Symptomatic </span><span class="ch">\n</span><span class="st">&amp; not contagious&quot;</span>,</a>
<a class="sourceLine" id="cb23-19" title="19"><span class="st">&quot;Post-COVID immune&quot;</span>,</a>
<a class="sourceLine" id="cb23-20" title="20"><span class="st">&quot;Naturally immune&quot;</span>,</a>
<a class="sourceLine" id="cb23-21" title="21"><span class="st">&quot;Death&quot;</span>,</a>
<a class="sourceLine" id="cb23-22" title="22"><span class="st">&quot;Left network&quot;</span>)</a></code></pre></div>
</div>
<div id="create-transition-matrix." class="section level2">
<h2>Create transition matrix.</h2>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">makeAgent &lt;-<span class="st"> </span><span class="cf">function</span>(psychstate,biostate,<span class="dt">age=</span><span class="dv">30</span>,<span class="dt">traveler=</span><span class="dv">0</span>,<span class="dt">is_infected =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb24-2" title="2">{</a>
<a class="sourceLine" id="cb24-3" title="3">  </a>
<a class="sourceLine" id="cb24-4" title="4">  <span class="kw">return</span> (<span class="kw">list</span>(<span class="dt">psychstate=</span>psychstate,</a>
<a class="sourceLine" id="cb24-5" title="5">               <span class="dt">biostate=</span>biostate,</a>
<a class="sourceLine" id="cb24-6" title="6">               <span class="dt">age=</span>age,</a>
<a class="sourceLine" id="cb24-7" title="7">               <span class="dt">nextbiostate=</span><span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb24-8" title="8">               <span class="dt">biostatecountdown=</span><span class="ot">NA</span>,<span class="dt">traveler=</span>traveler,<span class="dt">is_infected =</span> is_infected))</a>
<a class="sourceLine" id="cb24-9" title="9">}</a>
<a class="sourceLine" id="cb24-10" title="10"></a>
<a class="sourceLine" id="cb24-11" title="11"><span class="co"># * 1. Unexposed</span></a>
<a class="sourceLine" id="cb24-12" title="12"><span class="co"># * 2. Asymptomatic but infected/contagious</span></a>
<a class="sourceLine" id="cb24-13" title="13"><span class="co"># * 3. Symptomatic and contagious</span></a>
<a class="sourceLine" id="cb24-14" title="14"><span class="co"># * 4. Symptomatic and not contagious</span></a>
<a class="sourceLine" id="cb24-15" title="15"><span class="co"># * 5. Post-COVID Immune</span></a>
<a class="sourceLine" id="cb24-16" title="16"><span class="co"># * 6. Naturally immune (will not contract)</span></a>
<a class="sourceLine" id="cb24-17" title="17"><span class="co"># * 7. Death</span></a>
<a class="sourceLine" id="cb24-18" title="18"><span class="co"># * 8. Left network</span></a>
<a class="sourceLine" id="cb24-19" title="19"></a>
<a class="sourceLine" id="cb24-20" title="20"></a>
<a class="sourceLine" id="cb24-21" title="21">bioTransition &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,STATES,STATES)</a>
<a class="sourceLine" id="cb24-22" title="22">bioMin &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>,STATES)      <span class="co">#state time minimum</span></a>
<a class="sourceLine" id="cb24-23" title="23">bioMax &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>,STATES)      <span class="co">#state time maximum</span></a>
<a class="sourceLine" id="cb24-24" title="24"></a>
<a class="sourceLine" id="cb24-25" title="25"></a>
<a class="sourceLine" id="cb24-26" title="26"></a>
<a class="sourceLine" id="cb24-27" title="27">bioMin[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">3</span>            <span class="co">#infected but asymptomatic for 3 to 10 days</span></a>
<a class="sourceLine" id="cb24-28" title="28">bioMax[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">10</span>         </a>
<a class="sourceLine" id="cb24-29" title="29">bioTransition[<span class="dv">2</span>,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="fl">.1</span>  <span class="co">#transition to infected with symptoms</span></a>
<a class="sourceLine" id="cb24-30" title="30">bioTransition[<span class="dv">2</span>,<span class="dv">5</span>] &lt;-<span class="st"> </span><span class="fl">.90</span>  <span class="co">#transition to no longer contagious/cured</span></a>
<a class="sourceLine" id="cb24-31" title="31"></a>
<a class="sourceLine" id="cb24-32" title="32"></a>
<a class="sourceLine" id="cb24-33" title="33">bioMin[<span class="dv">3</span>] &lt;-<span class="st">    </span><span class="dv">3</span>             <span class="co">#symptoms + contagion</span></a>
<a class="sourceLine" id="cb24-34" title="34">bioMax[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="dv">8</span>                <span class="co">#symptoms + contagion max</span></a>
<a class="sourceLine" id="cb24-35" title="35">bioTransition[<span class="dv">3</span>,<span class="dv">4</span>] &lt;-<span class="st">  </span><span class="fl">.95</span>    <span class="co">#transitioon to no longer contagious</span></a>
<a class="sourceLine" id="cb24-36" title="36">bioTransition[<span class="dv">3</span>,<span class="dv">7</span>] &lt;-<span class="st">  </span><span class="fl">.05</span>    <span class="co">#transitioon to death state </span></a>
<a class="sourceLine" id="cb24-37" title="37"></a>
<a class="sourceLine" id="cb24-38" title="38"></a>
<a class="sourceLine" id="cb24-39" title="39">bioMin[<span class="dv">4</span>] &lt;-<span class="st"> </span><span class="dv">1</span>          <span class="co">#symptoms bot no longer contagiious</span></a>
<a class="sourceLine" id="cb24-40" title="40">bioMax[<span class="dv">4</span>] &lt;-<span class="st"> </span><span class="dv">7</span></a>
<a class="sourceLine" id="cb24-41" title="41">bioTransition[<span class="dv">4</span>,<span class="dv">5</span>] &lt;-<span class="st"> </span><span class="dv">1</span>  <span class="co">#Transition to &#39;immune&#39; cured state.</span></a>
<a class="sourceLine" id="cb24-42" title="42"></a>
<a class="sourceLine" id="cb24-43" title="43"></a>
<a class="sourceLine" id="cb24-44" title="44"></a>
<a class="sourceLine" id="cb24-45" title="45"></a>
<a class="sourceLine" id="cb24-46" title="46">setAgentState&lt;-<span class="st"> </span><span class="cf">function</span>(agent, biostate)</a>
<a class="sourceLine" id="cb24-47" title="47">{</a>
<a class="sourceLine" id="cb24-48" title="48">  agent<span class="op">$</span>biostate &lt;-<span class="st"> </span>biostate</a>
<a class="sourceLine" id="cb24-49" title="49">  <span class="cf">if</span>(<span class="kw">sum</span>(bioTransition[biostate,])<span class="op">&gt;</span><span class="dv">0</span>) <span class="co"># this state transitions to something else.</span></a>
<a class="sourceLine" id="cb24-50" title="50">  {</a>
<a class="sourceLine" id="cb24-51" title="51">    <span class="co">##which state do we go to?</span></a>
<a class="sourceLine" id="cb24-52" title="52">     agent<span class="op">$</span>biostatecountdown &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dt">x=</span><span class="kw">seq</span>(bioMin[biostate],bioMax[biostate]),<span class="dv">1</span>) <span class="co">#how long will we state in this state?</span></a>
<a class="sourceLine" id="cb24-53" title="53">     agent<span class="op">$</span>nextbiostate &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>STATES, <span class="dt">prob=</span>bioTransition[agent<span class="op">$</span>biostate,],<span class="dt">size=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb24-54" title="54">     </a>
<a class="sourceLine" id="cb24-55" title="55">  } <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb24-56" title="56">   agent<span class="op">$</span>biostatecountdown &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb24-57" title="57">   agent<span class="op">$</span>nextbiostate &lt;-<span class="st"> </span><span class="ot">NA</span>   <span class="co">##just so we can tell if the agent is finished.</span></a>
<a class="sourceLine" id="cb24-58" title="58">  }</a>
<a class="sourceLine" id="cb24-59" title="59">  <span class="kw">return</span>(agent) </a>
<a class="sourceLine" id="cb24-60" title="60">}</a>
<a class="sourceLine" id="cb24-61" title="61"></a>
<a class="sourceLine" id="cb24-62" title="62">transitionAgent&lt;-<span class="st"> </span><span class="cf">function</span>(agent)</a>
<a class="sourceLine" id="cb24-63" title="63">{</a>
<a class="sourceLine" id="cb24-64" title="64">   <span class="kw">return</span>(<span class="kw">setAgentState</span>(agent,agent<span class="op">$</span>nextbiostate))</a>
<a class="sourceLine" id="cb24-65" title="65">}</a>
<a class="sourceLine" id="cb24-66" title="66"></a>
<a class="sourceLine" id="cb24-67" title="67">updateAgent&lt;-<span class="st"> </span><span class="cf">function</span>(agent)</a>
<a class="sourceLine" id="cb24-68" title="68">{</a>
<a class="sourceLine" id="cb24-69" title="69">  <span class="cf">if</span>(<span class="op">!</span><span class="kw">is.na</span>(agent<span class="op">$</span>biostatecountdown))</a>
<a class="sourceLine" id="cb24-70" title="70">  {</a>
<a class="sourceLine" id="cb24-71" title="71">   agent<span class="op">$</span>biostatecountdown &lt;-<span class="st"> </span>agent<span class="op">$</span>biostatecountdown <span class="dv">-1</span></a>
<a class="sourceLine" id="cb24-72" title="72">    <span class="cf">if</span>(agent<span class="op">$</span>biostatecountdown <span class="op">&lt;=</span><span class="dv">0</span>)  <span class="co">##new state</span></a>
<a class="sourceLine" id="cb24-73" title="73">    {</a>
<a class="sourceLine" id="cb24-74" title="74">       agent &lt;-<span class="st"> </span><span class="kw">transitionAgent</span>(agent)</a>
<a class="sourceLine" id="cb24-75" title="75"></a>
<a class="sourceLine" id="cb24-76" title="76">    }</a>
<a class="sourceLine" id="cb24-77" title="77">  }</a>
<a class="sourceLine" id="cb24-78" title="78">   <span class="kw">return</span>(agent)</a>
<a class="sourceLine" id="cb24-79" title="79">}</a>
<a class="sourceLine" id="cb24-80" title="80"></a>
<a class="sourceLine" id="cb24-81" title="81">setAgentStatusInfected&lt;-<span class="st"> </span><span class="cf">function</span>(agent,<span class="dt">status=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb24-82" title="82">{</a>
<a class="sourceLine" id="cb24-83" title="83">   agent<span class="op">$</span>is_infected &lt;-<span class="st"> </span>status</a>
<a class="sourceLine" id="cb24-84" title="84">   <span class="kw">return</span>(agent)</a>
<a class="sourceLine" id="cb24-85" title="85">}</a></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">par</span>(<span class="dt">xpd=</span><span class="ot">NA</span>,<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb25-2" title="2"><span class="kw">gplot</span>(bioTransition,<span class="dt">label=</span>STATELABELS)</a></code></pre></div>
<p><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-3-1.png" width="768" /></p>
</div>
<div id="social-model" class="section level2">
<h2>Social model</h2>
<p>This is not quite right, because we’d really expect interactions to be clumpy–you interact with the same people every day, but this model is like the opinion dynamics model in that anyone can interact with anyone. Let’s make a network using preferential attachment to represent that social world. We can make a couple of them and add them together to represent how we each have different types of relationships and interactions–you may be the president of your drama club and so are a central member, but you are also in a pottery class where you don’t talk to very many people (although your teacher does).</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">makeNetwork&lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">numAgents=</span><span class="dv">5</span>,<span class="dt">numsets=</span><span class="dv">3</span>,<span class="dt">steps=</span><span class="dv">1</span>,<span class="dt">power=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb26-2" title="2">{</a>
<a class="sourceLine" id="cb26-3" title="3">  ord &lt;-<span class="st"> </span><span class="kw">sample</span>(numAgents)</a>
<a class="sourceLine" id="cb26-4" title="4">  </a>
<a class="sourceLine" id="cb26-5" title="5">  <span class="co">#print(&quot;____________________ord&quot;)</span></a>
<a class="sourceLine" id="cb26-6" title="6">  <span class="co">#print(ord)</span></a>
<a class="sourceLine" id="cb26-7" title="7">  </a>
<a class="sourceLine" id="cb26-8" title="8"> </a>
<a class="sourceLine" id="cb26-9" title="9">  <span class="co">#old_agent_order &lt;&lt;- ord </span></a>
<a class="sourceLine" id="cb26-10" title="10"> </a>
<a class="sourceLine" id="cb26-11" title="11">  tmp&lt;-<span class="kw">as_adjacency_matrix</span>(<span class="kw">sample_pa</span>(numAgents,<span class="dt">power=</span>power),<span class="dt">sparse=</span>F)</a>
<a class="sourceLine" id="cb26-12" title="12"></a>
<a class="sourceLine" id="cb26-13" title="13">  tmp &lt;-<span class="st"> </span>tmp <span class="op">+</span><span class="st"> </span><span class="kw">t</span>(tmp)</a>
<a class="sourceLine" id="cb26-14" title="14"></a>
<a class="sourceLine" id="cb26-15" title="15">  tmp &lt;-<span class="st"> </span>tmp[ord,ord]</a>
<a class="sourceLine" id="cb26-16" title="16"></a>
<a class="sourceLine" id="cb26-17" title="17">  <span class="cf">if</span>(numsets<span class="op">&gt;</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb26-18" title="18">  {</a>
<a class="sourceLine" id="cb26-19" title="19">    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>numsets)</a>
<a class="sourceLine" id="cb26-20" title="20">  {</a>
<a class="sourceLine" id="cb26-21" title="21">    ord &lt;-<span class="st"> </span><span class="kw">sample</span>(numAgents)</a>
<a class="sourceLine" id="cb26-22" title="22">     </a>
<a class="sourceLine" id="cb26-23" title="23">    sn2 &lt;-<span class="kw">as_adjacency_matrix</span>(<span class="kw">sample_pa</span>(numAgents,<span class="dt">power=</span>power),<span class="dt">sparse=</span>F)[ord,ord]</a>
<a class="sourceLine" id="cb26-24" title="24">    tmp &lt;-<span class="st"> </span>tmp <span class="op">+</span><span class="st"> </span>sn2 <span class="op">+</span><span class="st"> </span><span class="kw">t</span>(sn2)</a>
<a class="sourceLine" id="cb26-25" title="25">    </a>
<a class="sourceLine" id="cb26-26" title="26">   }</a>
<a class="sourceLine" id="cb26-27" title="27">  }</a>
<a class="sourceLine" id="cb26-28" title="28">  <span class="cf">if</span>(steps<span class="op">&gt;</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb26-29" title="29">  {</a>
<a class="sourceLine" id="cb26-30" title="30">   <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>steps)</a>
<a class="sourceLine" id="cb26-31" title="31">   {</a>
<a class="sourceLine" id="cb26-32" title="32">      tmp &lt;-<span class="st"> </span>tmp <span class="op">+</span><span class="st"> </span>tmp <span class="op">%*%</span><span class="st"> </span>tmp  <span class="co">## iterate to neighbors</span></a>
<a class="sourceLine" id="cb26-33" title="33">   }</a>
<a class="sourceLine" id="cb26-34" title="34">  }</a>
<a class="sourceLine" id="cb26-35" title="35">  (tmp<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">+</span><span class="dv">0</span></a>
<a class="sourceLine" id="cb26-36" title="36">   </a>
<a class="sourceLine" id="cb26-37" title="37"></a>
<a class="sourceLine" id="cb26-38" title="38">}</a></code></pre></div>
</div>
<div id="adding-a-new-agent-to-the-network" class="section level2">
<h2>Adding a new agent to the network</h2>
<p>Here, we write code that will grow the network by adding new agents.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1">addAgentToNetwork&lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">numAgents=</span><span class="dv">5</span>,<span class="dt">prev_network =</span> socialnetwork,<span class="dt">connection_number=</span><span class="dv">1</span>,<span class="dt">self_connected=</span><span class="dv">1</span>,pool)</a>
<a class="sourceLine" id="cb27-2" title="2">{</a>
<a class="sourceLine" id="cb27-3" title="3">  </a>
<a class="sourceLine" id="cb27-4" title="4">   <span class="cf">if</span>(connection_number <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb27-5" title="5">     </a>
<a class="sourceLine" id="cb27-6" title="6">     connection_number &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb27-7" title="7">   }</a>
<a class="sourceLine" id="cb27-8" title="8"></a>
<a class="sourceLine" id="cb27-9" title="9">   number_of_rows &lt;-<span class="st"> </span><span class="kw">nrow</span>(prev_network)</a>
<a class="sourceLine" id="cb27-10" title="10">   </a>
<a class="sourceLine" id="cb27-11" title="11">   starting_point &lt;-<span class="st"> </span>number_of_rows<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb27-12" title="12">   end_point &lt;-<span class="st"> </span>number_of_rows <span class="op">+</span><span class="st"> </span>numAgents</a>
<a class="sourceLine" id="cb27-13" title="13"></a>
<a class="sourceLine" id="cb27-14" title="14">  </a>
<a class="sourceLine" id="cb27-15" title="15">    <span class="cf">for</span>(i <span class="cf">in</span> starting_point<span class="op">:</span>end_point) {</a>
<a class="sourceLine" id="cb27-16" title="16"></a>
<a class="sourceLine" id="cb27-17" title="17">      prev_network &lt;-<span class="st"> </span><span class="kw">rbind</span>(prev_network, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb27-18" title="18">      prev_network &lt;-<span class="st"> </span><span class="kw">cbind</span>(prev_network, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb27-19" title="19"></a>
<a class="sourceLine" id="cb27-20" title="20">    </a>
<a class="sourceLine" id="cb27-21" title="21">    </a>
<a class="sourceLine" id="cb27-22" title="22">  </a>
<a class="sourceLine" id="cb27-23" title="23">    }  </a>
<a class="sourceLine" id="cb27-24" title="24"></a>
<a class="sourceLine" id="cb27-25" title="25">   </a>
<a class="sourceLine" id="cb27-26" title="26">  <span class="cf">if</span>(number_of_rows<span class="op">&gt;=</span><span class="st"> </span>connection_number ){</a>
<a class="sourceLine" id="cb27-27" title="27">  </a>
<a class="sourceLine" id="cb27-28" title="28">    <span class="co">#x &lt;- 1:number_of_rows</span></a>
<a class="sourceLine" id="cb27-29" title="29">    </a>
<a class="sourceLine" id="cb27-30" title="30">    u &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>number_of_rows</a>
<a class="sourceLine" id="cb27-31" title="31"></a>
<a class="sourceLine" id="cb27-32" title="32">    <span class="cf">for</span> (val <span class="cf">in</span> u) {</a>
<a class="sourceLine" id="cb27-33" title="33">      </a>
<a class="sourceLine" id="cb27-34" title="34">      <span class="cf">if</span>((pool[[val]]<span class="op">$</span>biostate <span class="op">!=</span><span class="st"> </span><span class="dv">8</span>) ){</a>
<a class="sourceLine" id="cb27-35" title="35"></a>
<a class="sourceLine" id="cb27-36" title="36">        <span class="cf">if</span>((pool[[val]]<span class="op">$</span>biostate <span class="op">!=</span><span class="st"> </span><span class="dv">7</span>)){</a>
<a class="sourceLine" id="cb27-37" title="37">          x&lt;-u</a>
<a class="sourceLine" id="cb27-38" title="38">        }</a>
<a class="sourceLine" id="cb27-39" title="39">      }</a>
<a class="sourceLine" id="cb27-40" title="40">     </a>
<a class="sourceLine" id="cb27-41" title="41">    }    </a>
<a class="sourceLine" id="cb27-42" title="42">    </a>
<a class="sourceLine" id="cb27-43" title="43">    </a>
<a class="sourceLine" id="cb27-44" title="44">     a &lt;-<span class="st"> </span><span class="kw">sample</span>(x, connection_number)</a>
<a class="sourceLine" id="cb27-45" title="45">     <span class="co"># print(&quot;SSSSSSSSSSSSSSSSSSSS&quot;)</span></a>
<a class="sourceLine" id="cb27-46" title="46">     <span class="co"># print(a)</span></a>
<a class="sourceLine" id="cb27-47" title="47">     <span class="co"># </span></a>
<a class="sourceLine" id="cb27-48" title="48">   </a>
<a class="sourceLine" id="cb27-49" title="49">    </a>
<a class="sourceLine" id="cb27-50" title="50">    <span class="co"># repeat{</span></a>
<a class="sourceLine" id="cb27-51" title="51">    <span class="co">#   </span></a>
<a class="sourceLine" id="cb27-52" title="52">    <span class="co">#   if((pool[[a]]$biostate != 8) ){</span></a>
<a class="sourceLine" id="cb27-53" title="53">    <span class="co">#     </span></a>
<a class="sourceLine" id="cb27-54" title="54">    <span class="co">#     if((pool[[a]]$biostate != 7)){</span></a>
<a class="sourceLine" id="cb27-55" title="55">    <span class="co">#       break</span></a>
<a class="sourceLine" id="cb27-56" title="56">    <span class="co">#     }</span></a>
<a class="sourceLine" id="cb27-57" title="57">    <span class="co">#     </span></a>
<a class="sourceLine" id="cb27-58" title="58">    <span class="co">#   }</span></a>
<a class="sourceLine" id="cb27-59" title="59">    <span class="co"># }</span></a>
<a class="sourceLine" id="cb27-60" title="60">   <span class="co"># print(a)</span></a>
<a class="sourceLine" id="cb27-61" title="61">  </a>
<a class="sourceLine" id="cb27-62" title="62">    </a>
<a class="sourceLine" id="cb27-63" title="63">     <span class="cf">for</span>(i <span class="cf">in</span> starting_point<span class="op">:</span>end_point) {</a>
<a class="sourceLine" id="cb27-64" title="64">          <span class="cf">if</span>(self_connected<span class="op">==</span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb27-65" title="65">            </a>
<a class="sourceLine" id="cb27-66" title="66">             prev_network[i,i] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb27-67" title="67">          }</a>
<a class="sourceLine" id="cb27-68" title="68">      </a>
<a class="sourceLine" id="cb27-69" title="69">        current_new_agent &lt;-i</a>
<a class="sourceLine" id="cb27-70" title="70">        <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(a)) {</a>
<a class="sourceLine" id="cb27-71" title="71">          </a>
<a class="sourceLine" id="cb27-72" title="72">          <span class="co">#print(a[i])</span></a>
<a class="sourceLine" id="cb27-73" title="73">          prev_network[a[i],current_new_agent] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb27-74" title="74">          prev_network[current_new_agent,a[i]] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb27-75" title="75">        }</a>
<a class="sourceLine" id="cb27-76" title="76">   </a>
<a class="sourceLine" id="cb27-77" title="77">      </a>
<a class="sourceLine" id="cb27-78" title="78">      </a>
<a class="sourceLine" id="cb27-79" title="79">    }     </a>
<a class="sourceLine" id="cb27-80" title="80">    </a>
<a class="sourceLine" id="cb27-81" title="81">    </a>
<a class="sourceLine" id="cb27-82" title="82">    </a>
<a class="sourceLine" id="cb27-83" title="83">  }</a>
<a class="sourceLine" id="cb27-84" title="84">   <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb27-85" title="85">     </a>
<a class="sourceLine" id="cb27-86" title="86">     <span class="co">#x &lt;- 1:number_of_rows</span></a>
<a class="sourceLine" id="cb27-87" title="87">     <span class="co"># print(&quot;SSSSSSSSSggfgfgSSSSSSSSSSS&quot;)</span></a>
<a class="sourceLine" id="cb27-88" title="88">     <span class="co"># print(a)</span></a>
<a class="sourceLine" id="cb27-89" title="89">     <span class="co">#     </span></a>
<a class="sourceLine" id="cb27-90" title="90">    u &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>number_of_rows</a>
<a class="sourceLine" id="cb27-91" title="91"></a>
<a class="sourceLine" id="cb27-92" title="92">    <span class="cf">for</span> (val <span class="cf">in</span> u) {</a>
<a class="sourceLine" id="cb27-93" title="93">      </a>
<a class="sourceLine" id="cb27-94" title="94">      <span class="cf">if</span>((pool[[val]]<span class="op">$</span>biostate <span class="op">!=</span><span class="st"> </span><span class="dv">8</span>) ){</a>
<a class="sourceLine" id="cb27-95" title="95"></a>
<a class="sourceLine" id="cb27-96" title="96">        <span class="cf">if</span>((pool[[val]]<span class="op">$</span>biostate <span class="op">!=</span><span class="st"> </span><span class="dv">7</span>)){</a>
<a class="sourceLine" id="cb27-97" title="97">          x&lt;-u</a>
<a class="sourceLine" id="cb27-98" title="98">        }</a>
<a class="sourceLine" id="cb27-99" title="99">      }</a>
<a class="sourceLine" id="cb27-100" title="100">     </a>
<a class="sourceLine" id="cb27-101" title="101">    }      </a>
<a class="sourceLine" id="cb27-102" title="102">     </a>
<a class="sourceLine" id="cb27-103" title="103">     a &lt;-<span class="st"> </span><span class="kw">sample</span>(x, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb27-104" title="104">    </a>
<a class="sourceLine" id="cb27-105" title="105">    </a>
<a class="sourceLine" id="cb27-106" title="106">  </a>
<a class="sourceLine" id="cb27-107" title="107">    </a>
<a class="sourceLine" id="cb27-108" title="108">   <span class="co"># print(a)</span></a>
<a class="sourceLine" id="cb27-109" title="109">  </a>
<a class="sourceLine" id="cb27-110" title="110">    </a>
<a class="sourceLine" id="cb27-111" title="111">     <span class="cf">for</span>(i <span class="cf">in</span> starting_point<span class="op">:</span>end_point) {</a>
<a class="sourceLine" id="cb27-112" title="112">          <span class="cf">if</span>(self_connected<span class="op">==</span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb27-113" title="113">            </a>
<a class="sourceLine" id="cb27-114" title="114">             prev_network[i,i] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb27-115" title="115">          }</a>
<a class="sourceLine" id="cb27-116" title="116">      </a>
<a class="sourceLine" id="cb27-117" title="117">        current_new_agent &lt;-i</a>
<a class="sourceLine" id="cb27-118" title="118">        <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(a)) {</a>
<a class="sourceLine" id="cb27-119" title="119">          </a>
<a class="sourceLine" id="cb27-120" title="120">          <span class="co">#print(a[i])</span></a>
<a class="sourceLine" id="cb27-121" title="121">          prev_network[a[i],current_new_agent] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb27-122" title="122">          prev_network[current_new_agent,a[i]] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb27-123" title="123">        }</a>
<a class="sourceLine" id="cb27-124" title="124">   </a>
<a class="sourceLine" id="cb27-125" title="125">      </a>
<a class="sourceLine" id="cb27-126" title="126">      </a>
<a class="sourceLine" id="cb27-127" title="127">    }    </a>
<a class="sourceLine" id="cb27-128" title="128">     </a>
<a class="sourceLine" id="cb27-129" title="129">     </a>
<a class="sourceLine" id="cb27-130" title="130">     </a>
<a class="sourceLine" id="cb27-131" title="131">   }</a>
<a class="sourceLine" id="cb27-132" title="132"> </a>
<a class="sourceLine" id="cb27-133" title="133">   </a>
<a class="sourceLine" id="cb27-134" title="134"></a>
<a class="sourceLine" id="cb27-135" title="135"> </a>
<a class="sourceLine" id="cb27-136" title="136">  <span class="kw">return</span>(prev_network)</a>
<a class="sourceLine" id="cb27-137" title="137">    </a>
<a class="sourceLine" id="cb27-138" title="138">  </a>
<a class="sourceLine" id="cb27-139" title="139">}</a></code></pre></div>
</div>
<div id="background" class="section level2">
<h2>Background</h2>
<p>A key step in contingency planning for a possible pandemic in a community is barring entry of travelers in the community. The potential for infectious diseases to spread in a community rapidly through well-connected infected travelers in the community is very high. Past researches looked into the effect of the international travel ban on reducing the spread of disease in countries. Partial restriction of travel helps in slowing the spread if the global number of cases of infection is low (Hollingsworth et al., 2006). According to Epstein et al. (2007), international air travel restrictions may provide a small but important delay in the spread of a pandemic, especially if other disease control measures are implemented during a timeframe. Using the mathematical model, Cooper et al. (2006) concluded that restrictions on air travel would achieve very little. This is probably because a virus may transmit from one person to another very quickly and affects many people. Once a major outbreak is underway, banning flights from affected cities would be effective at significantly delaying spread only if almost all travel between cities could be stopped almost as soon as an outbreak was detected in each city.</p>
<p>One of the main reasons against oversea travel ban is because it has a big negative economic impact in a country if we stop adults traveling oversea (Lam et al., 2011). But for small and moderate length communities whose economic activities circulated within the community, a travel restriction may be helpful during a pandemic. If the health care systems for these communities are not prepared to deal with a pandemic, it is better to enforce some sort of travel ban so that the health care system does not overwhelm with patients. This will help to keep a check on the number of patients. In the traditional SIR model (Smith &amp; Moore, 2004), it is not defined how adding travelers to the scenario will affect the spread of disease. So, we created an agent-based social model for a community where we will be adding travelers to the local populations to see how a disease spreads in the whole community. We will be looking into the worst-case scenario in the model, where travelers will enter the community but nobody leaves within a timeframe from the community. We will vary different variables in the simulations to see the disease progress in the community within a specific timeframe.</p>
<p>References</p>
<ul>
<li>Cooper, B. S., Pitman, R. J., Edmunds, W. J., &amp; Gay, N. J. (2006). Delaying the international spread of pandemic influenza. PLoS Medicine, 3(6).</li>
<li>Epstein, J. M., Goedecke, D. M., Yu, F., Morris, R. J., Wagener, D. K., &amp; Bobashev, G. V. (2007). Controlling pandemic flu: The value of international air travel restrictions. PloS One, 2(5).</li>
<li>Hollingsworth, T. D., Ferguson, N. M., &amp; Anderson, R. M. (2006). Will travel restrictions control the international spread of pandemic influenza? Nature Medicine, 12(5), 497–499.</li>
<li>Lam, E. H., Cowling, B. J., Cook, A. R., Wong, J. Y., Lau, M. S., &amp; Nishiura, H. (2011). The feasibility of age-specific travel restrictions during influenza pandemics. Theoretical Biology and Medical Modelling, 8(1), 44.</li>
<li>Smith, D., &amp; Moore, L. (2004). The SIR Model for Spread of Disease: The Differential Equation Model. Loci.(Originally Convergence.) <a href="Https://Www" class="uri">Https://Www</a>. Maa. Org/Press/Periodicals/Loci/Joma/the-Sir-Model-for-Spread-of-Disease-the-Differential-Equation-Model.</li>
</ul>
</div>
<div id="travel-ban-lift-and-allowing-traveler-to-the-community" class="section level2">
<h2>Travel ban lift and allowing traveler to the community</h2>
<div id="social-connection-of-the-travelers" class="section level3">
<h3>Social connection of the travelers</h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1">mygplot_updated &lt;-<span class="st"> </span><span class="cf">function</span>(coord, network,states,<span class="dt">main=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb28-2" title="2">{</a>
<a class="sourceLine" id="cb28-3" title="3">  <span class="cf">if</span>(<span class="kw">is.null</span>(coord))</a>
<a class="sourceLine" id="cb28-4" title="4">  {</a>
<a class="sourceLine" id="cb28-5" title="5">    coord  &lt;-<span class="st"> </span><span class="kw">gplot.layout.fruchtermanreingold</span>(network,<span class="dt">layout.par=</span><span class="kw">list</span>(<span class="dt">niter=</span><span class="dv">500</span>))</a>
<a class="sourceLine" id="cb28-6" title="6">      <span class="co">#gplot.layout.fruchtermanreingold(network,layout.par=list(niter=500))</span></a>
<a class="sourceLine" id="cb28-7" title="7">      <span class="co">#ggnet2(network, mode = &quot;fruchtermanreingold&quot;, layout.par=list(niter=500))</span></a>
<a class="sourceLine" id="cb28-8" title="8">      <span class="co">#gplot.layout.fruchtermanreingold(network,layout.par=list(niter=500))</span></a>
<a class="sourceLine" id="cb28-9" title="9">  }</a>
<a class="sourceLine" id="cb28-10" title="10">  </a>
<a class="sourceLine" id="cb28-11" title="11">   newmin &lt;-<span class="st"> </span><span class="kw">mean</span>(coord[,<span class="dv">2</span>]) <span class="op">-</span><span class="st"> </span>(<span class="op">-</span><span class="kw">min</span>(coord[,<span class="dv">2</span>]) <span class="op">+</span><span class="st"> </span><span class="kw">mean</span>(coord[,<span class="dv">2</span>])) <span class="op">*</span><span class="st"> </span><span class="fl">1.4</span></a>
<a class="sourceLine" id="cb28-12" title="12">   palette=<span class="kw">c</span>(<span class="st">&quot;white&quot;</span>,<span class="st">&quot;yellow&quot;</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;green&quot;</span>,<span class="st">&quot;darkgreen&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;black&quot;</span>,<span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb28-13" title="13">   <span class="kw">plot</span>(coord,<span class="dt">col=</span><span class="st">&quot;black&quot;</span>,<span class="dt">bty=</span><span class="st">&quot;n&quot;</span>,<span class="dt">pch=</span><span class="dv">16</span>,<span class="dt">cex=</span><span class="fl">2.7</span>,<span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>,<span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>,<span class="dt">main=</span>main,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">axes=</span>F,</a>
<a class="sourceLine" id="cb28-14" title="14">        <span class="dt">ylim=</span><span class="kw">c</span>(newmin,<span class="kw">max</span>(coord[,<span class="dv">2</span>])),<span class="dt">type=</span><span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb28-15" title="15">   </a>
<a class="sourceLine" id="cb28-16" title="16">   </a>
<a class="sourceLine" id="cb28-17" title="17">   travelers &lt;-<span class="st"> </span><span class="kw">sapply</span>(pool,<span class="cf">function</span>(x){x<span class="op">$</span>traveler})</a>
<a class="sourceLine" id="cb28-18" title="18">   </a>
<a class="sourceLine" id="cb28-19" title="19">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(network))</a>
<a class="sourceLine" id="cb28-20" title="20">  {</a>
<a class="sourceLine" id="cb28-21" title="21">    <span class="cf">if</span>(<span class="kw">sum</span>(network[i,])<span class="op">&gt;</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb28-22" title="22">    {</a>
<a class="sourceLine" id="cb28-23" title="23">     <span class="kw">segments</span>(coord[i,<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb28-24" title="24">            coord[i,<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb28-25" title="25">            coord[network[i,]<span class="op">==</span><span class="dv">1</span>,<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb28-26" title="26">            coord[network[i,]<span class="op">==</span><span class="dv">1</span>,<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;grey40&quot;</span>)</a>
<a class="sourceLine" id="cb28-27" title="27">    } </a>
<a class="sourceLine" id="cb28-28" title="28">  }</a>
<a class="sourceLine" id="cb28-29" title="29">       <span class="kw">points</span>(coord,<span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">16</span>,<span class="dv">15</span>)[travelers<span class="op">+</span><span class="dv">1</span>],<span class="dt">cex=</span><span class="fl">2.3</span>,<span class="dt">col=</span> palette[states])</a>
<a class="sourceLine" id="cb28-30" title="30">       <span class="kw">points</span>(coord,<span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>)[travelers<span class="op">+</span><span class="dv">1</span>],<span class="dt">cex=</span><span class="fl">2.3</span>,<span class="dt">col=</span><span class="st">&quot;black&quot;</span>)</a>
<a class="sourceLine" id="cb28-31" title="31">       </a>
<a class="sourceLine" id="cb28-32" title="32">      <span class="kw">legend</span>(<span class="kw">mean</span>(coord[,<span class="dv">1</span>]),<span class="kw">min</span>(coord[,<span class="dv">2</span>]),<span class="dt">bty=</span><span class="st">&#39;n&#39;</span>,<span class="dt">y.intersp=</span>.<span class="dv">7</span>,<span class="dt">cex=</span>.<span class="dv">8</span>,</a>
<a class="sourceLine" id="cb28-33" title="33">              STATENAMES, <span class="dt">pch=</span><span class="dv">16</span>,<span class="dt">col=</span>palette)</a>
<a class="sourceLine" id="cb28-34" title="34">      </a>
<a class="sourceLine" id="cb28-35" title="35">      <span class="cf">if</span>(<span class="kw">sum</span>(travelers)<span class="op">&gt;</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb28-36" title="36">      {</a>
<a class="sourceLine" id="cb28-37" title="37">        <span class="co">#print(&quot;plotting rectangle&quot;)</span></a>
<a class="sourceLine" id="cb28-38" title="38">        <span class="kw">rect</span>(<span class="kw">min</span>(coord[travelers,<span class="dv">1</span>]),</a>
<a class="sourceLine" id="cb28-39" title="39">             <span class="kw">min</span>(coord[travelers,<span class="dv">2</span>]),</a>
<a class="sourceLine" id="cb28-40" title="40">             <span class="kw">max</span>(coord[travelers,<span class="dv">1</span>]),</a>
<a class="sourceLine" id="cb28-41" title="41">             <span class="kw">max</span>(coord[travelers,<span class="dv">2</span>]))</a>
<a class="sourceLine" id="cb28-42" title="42">          </a>
<a class="sourceLine" id="cb28-43" title="43">      }</a>
<a class="sourceLine" id="cb28-44" title="44">  </a>
<a class="sourceLine" id="cb28-45" title="45">              </a>
<a class="sourceLine" id="cb28-46" title="46">      <span class="kw">return</span> (coord)</a>
<a class="sourceLine" id="cb28-47" title="47">}</a>
<a class="sourceLine" id="cb28-48" title="48"><span class="co">#cc &lt;-  mygplot_updated(coord=NULL,socialnetwork,rep(1,nrow(socialnetwork)),main=&quot;Initial state&quot;)</span></a></code></pre></div>
<div id="section" class="section level30">
<p></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1">travel_ban_lift &lt;-<span class="st"> </span><span class="cf">function</span>( enable_outside_travel_restriction_day,second_wave_day,</a>
<a class="sourceLine" id="cb29-2" title="2">                             <span class="dt">connection_number =</span> <span class="dv">1</span>, <span class="dt">will_affect_traveler =</span> <span class="dv">0</span>, <span class="dt">numDays =</span> <span class="dv">50</span>,</a>
<a class="sourceLine" id="cb29-3" title="3">                              <span class="dt">people_leave_status =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb29-4" title="4">                             <span class="dt">number_of_people_leave =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb29-5" title="5">                             <span class="dt">naturalImmunity =</span> <span class="fl">.01</span>,<span class="dt">numInteractions_value =</span> <span class="dv">14</span>,</a>
<a class="sourceLine" id="cb29-6" title="6">                              <span class="dt">contagionProb =</span> <span class="fl">.05</span>,<span class="co">####5% chance</span></a>
<a class="sourceLine" id="cb29-7" title="7">                             <span class="dt">sampleFromNetwork =</span> <span class="fl">.98</span>,<span class="dt">traveler_percentage_mean =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb29-8" title="8">                             <span class="dt">traveler_percentage_ceiling =</span> <span class="dv">2</span>, <span class="dt">traveler_increase =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb29-9" title="9">                             <span class="dt">boundary_of_traveler_change =</span> <span class="dv">2</span>, <span class="dt">traveler_interval_day =</span> <span class="dv">5</span>, </a>
<a class="sourceLine" id="cb29-10" title="10">                             <span class="dt">enable_second_wave =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb29-11" title="11">                             <span class="dt">enable_outside_travel_restriction =</span><span class="dv">0</span>,<span class="dt">need_to_update_graph_cord =</span> <span class="dv">0</span> ){ </a>
<a class="sourceLine" id="cb29-12" title="12"></a>
<a class="sourceLine" id="cb29-13" title="13"></a>
<a class="sourceLine" id="cb29-14" title="14"></a>
<a class="sourceLine" id="cb29-15" title="15"> </a>
<a class="sourceLine" id="cb29-16" title="16">  socialnetwork &lt;-<span class="st"> </span>original_network_of_agents</a>
<a class="sourceLine" id="cb29-17" title="17">  numAgents &lt;-<span class="st"> </span>numAgents_initial</a>
<a class="sourceLine" id="cb29-18" title="18">  people_left &lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb29-19" title="19">  </a>
<a class="sourceLine" id="cb29-20" title="20"></a>
<a class="sourceLine" id="cb29-21" title="21">  </a>
<a class="sourceLine" id="cb29-22" title="22">  plotNetwork &lt;-T</a>
<a class="sourceLine" id="cb29-23" title="23">  </a>
<a class="sourceLine" id="cb29-24" title="24">  <span class="co"># If i create the social network here, works ok</span></a>
<a class="sourceLine" id="cb29-25" title="25">  <span class="co">#socialnetwork &lt;-makeNetwork(numAgents,numsets=1,power=.5,steps=2)</span></a>
<a class="sourceLine" id="cb29-26" title="26">  <span class="co">#print(socialnetwork)</span></a>
<a class="sourceLine" id="cb29-27" title="27">  </a>
<a class="sourceLine" id="cb29-28" title="28">  <span class="co">#pool &lt;&lt;-pool_initial</span></a>
<a class="sourceLine" id="cb29-29" title="29">  </a>
<a class="sourceLine" id="cb29-30" title="30">  .GlobalEnv<span class="op">$</span>pool &lt;&lt;-<span class="st"> </span>pool_initial</a>
<a class="sourceLine" id="cb29-31" title="31">  </a>
<a class="sourceLine" id="cb29-32" title="32">  numInteractions &lt;-<span class="st">  </span><span class="kw">rep</span>(numInteractions_value,numDays) <span class="co">##interaction during no travel bans</span></a>
<a class="sourceLine" id="cb29-33" title="33">  numInteractions[enable_outside_travel_restriction_day<span class="op">:</span>second_wave_day] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(numInteractions_value<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>))  <span class="co">##interaction during travel restriction</span></a>
<a class="sourceLine" id="cb29-34" title="34">  </a>
<a class="sourceLine" id="cb29-35" title="35">  </a>
<a class="sourceLine" id="cb29-36" title="36">  local_population_infection_number_local_variable &lt;&lt;-<span class="st"> </span>local_population_infection_number</a>
<a class="sourceLine" id="cb29-37" title="37">  traveler_infection_number_local_variable &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb29-38" title="38"></a>
<a class="sourceLine" id="cb29-39" title="39">  <span class="cf">if</span>(plotNetwork)</a>
<a class="sourceLine" id="cb29-40" title="40">  {</a>
<a class="sourceLine" id="cb29-41" title="41">    cc &lt;-<span class="kw">mygplot_updated</span>(<span class="dt">coord=</span><span class="ot">NULL</span>,socialnetwork,<span class="kw">rep</span>(<span class="dv">1</span>,<span class="kw">nrow</span>(socialnetwork)),<span class="dt">main=</span><span class="st">&quot;Initial state&quot;</span>)</a>
<a class="sourceLine" id="cb29-42" title="42">    </a>
<a class="sourceLine" id="cb29-43" title="43">    xrange &lt;-<span class="st">   </span><span class="kw">range</span>(cc[,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb29-44" title="44">    xval &lt;-<span class="st"> </span>xrange[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span>(xrange[<span class="dv">2</span>]<span class="op">-</span>xrange[<span class="dv">1</span>])<span class="op">/</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb29-45" title="45">    yval &lt;-<span class="st"> </span><span class="kw">mean</span>(cc[,<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb29-46" title="46">    sd &lt;-<span class="st"> </span>(xrange[<span class="dv">2</span>]<span class="op">-</span>xrange[<span class="dv">1</span>]) <span class="op">/</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb29-47" title="47">  }  </a>
<a class="sourceLine" id="cb29-48" title="48"></a>
<a class="sourceLine" id="cb29-49" title="49">  </a>
<a class="sourceLine" id="cb29-50" title="50">  </a>
<a class="sourceLine" id="cb29-51" title="51"></a>
<a class="sourceLine" id="cb29-52" title="52">  disthistory &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,<span class="dt">ncol=</span>STATES,<span class="dt">nrow=</span>numDays)</a>
<a class="sourceLine" id="cb29-53" title="53">  </a>
<a class="sourceLine" id="cb29-54" title="54"> <span class="co"># pool &lt;&lt;-pool_initial</span></a>
<a class="sourceLine" id="cb29-55" title="55"></a>
<a class="sourceLine" id="cb29-56" title="56">  </a>
<a class="sourceLine" id="cb29-57" title="57">  <span class="cf">for</span>(day <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>numDays)</a>
<a class="sourceLine" id="cb29-58" title="58">  {</a>
<a class="sourceLine" id="cb29-59" title="59">      </a>
<a class="sourceLine" id="cb29-60" title="60">      </a>
<a class="sourceLine" id="cb29-61" title="61">       <span class="co">###################agent leaving Start</span></a>
<a class="sourceLine" id="cb29-62" title="62">    </a>
<a class="sourceLine" id="cb29-63" title="63">      <span class="co">#innetwork &lt;- sapply(.GlobalEnv$pool,function(y){!(y$biostate==7||y$biostate==8)})</span></a>
<a class="sourceLine" id="cb29-64" title="64">      <span class="cf">if</span>(<span class="op">!</span>enable_outside_travel_restriction){</a>
<a class="sourceLine" id="cb29-65" title="65">        <span class="cf">if</span>(people_leave_status){</a>
<a class="sourceLine" id="cb29-66" title="66">          <span class="co">####Hard coding day for people leave</span></a>
<a class="sourceLine" id="cb29-67" title="67">           <span class="co">#.GlobalEnv$pool &lt;- list.remove(.GlobalEnv$pool,  c(1))</span></a>
<a class="sourceLine" id="cb29-68" title="68">          </a>
<a class="sourceLine" id="cb29-69" title="69">          <span class="cf">if</span>(day <span class="op">==</span><span class="st"> </span>(second_wave_day<span class="op">+</span><span class="dv">7</span>)){</a>
<a class="sourceLine" id="cb29-70" title="70">                  </a>
<a class="sourceLine" id="cb29-71" title="71">                  number_of_people_leave &lt;-<span class="st"> </span><span class="kw">as.integer</span>((<span class="dv">1</span><span class="op">/</span><span class="dv">100</span>)<span class="op">*</span>numAgents) <span class="co">##1% will leave the system</span></a>
<a class="sourceLine" id="cb29-72" title="72">                  </a>
<a class="sourceLine" id="cb29-73" title="73">                      </a>
<a class="sourceLine" id="cb29-74" title="74">                    u &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>numAgents</a>
<a class="sourceLine" id="cb29-75" title="75">                </a>
<a class="sourceLine" id="cb29-76" title="76">                    <span class="cf">for</span> (val <span class="cf">in</span> u) {</a>
<a class="sourceLine" id="cb29-77" title="77">                      </a>
<a class="sourceLine" id="cb29-78" title="78">                      <span class="cf">if</span>((.GlobalEnv<span class="op">$</span>pool[[val]]<span class="op">$</span>biostate <span class="op">!=</span><span class="st"> </span><span class="dv">8</span>) ){</a>
<a class="sourceLine" id="cb29-79" title="79">                </a>
<a class="sourceLine" id="cb29-80" title="80">                        <span class="cf">if</span>((.GlobalEnv<span class="op">$</span>pool[[val]]<span class="op">$</span>biostate <span class="op">!=</span><span class="st"> </span><span class="dv">7</span>)){</a>
<a class="sourceLine" id="cb29-81" title="81">                          x&lt;-u</a>
<a class="sourceLine" id="cb29-82" title="82">                          </a>
<a class="sourceLine" id="cb29-83" title="83">                        }</a>
<a class="sourceLine" id="cb29-84" title="84">                      }</a>
<a class="sourceLine" id="cb29-85" title="85">                     </a>
<a class="sourceLine" id="cb29-86" title="86">                    }    </a>
<a class="sourceLine" id="cb29-87" title="87">                    </a>
<a class="sourceLine" id="cb29-88" title="88">                    a &lt;-<span class="st"> </span><span class="kw">sample</span>(x, number_of_people_leave)</a>
<a class="sourceLine" id="cb29-89" title="89">                    </a>
<a class="sourceLine" id="cb29-90" title="90">                            </a>
<a class="sourceLine" id="cb29-91" title="91">                    <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(a)) {</a>
<a class="sourceLine" id="cb29-92" title="92">                      </a>
<a class="sourceLine" id="cb29-93" title="93">                      <span class="co">#print(a[i])</span></a>
<a class="sourceLine" id="cb29-94" title="94">                      x &lt;-<span class="st"> </span>a[i]</a>
<a class="sourceLine" id="cb29-95" title="95">                      .GlobalEnv<span class="op">$</span>pool[[x]] &lt;-<span class="st"> </span><span class="kw">setAgentState</span>( .GlobalEnv<span class="op">$</span>pool[[x]],<span class="dv">8</span>)</a>
<a class="sourceLine" id="cb29-96" title="96">          </a>
<a class="sourceLine" id="cb29-97" title="97">                      socialnetwork[x,] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb29-98" title="98">                      socialnetwork[,x] &lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb29-99" title="99">                    }                </a>
<a class="sourceLine" id="cb29-100" title="100">                           </a>
<a class="sourceLine" id="cb29-101" title="101">                  </a>
<a class="sourceLine" id="cb29-102" title="102">                  </a>
<a class="sourceLine" id="cb29-103" title="103">                 </a>
<a class="sourceLine" id="cb29-104" title="104">          }          </a>
<a class="sourceLine" id="cb29-105" title="105">          <span class="cf">if</span>(day <span class="op">==</span><span class="st"> </span>(second_wave_day<span class="op">+</span><span class="dv">14</span>)){</a>
<a class="sourceLine" id="cb29-106" title="106">                  </a>
<a class="sourceLine" id="cb29-107" title="107">                  number_of_people_leave &lt;-<span class="st"> </span><span class="kw">as.integer</span>((<span class="dv">1</span><span class="op">/</span><span class="dv">100</span>)<span class="op">*</span>numAgents) <span class="co">##1% will leave the system</span></a>
<a class="sourceLine" id="cb29-108" title="108">                  </a>
<a class="sourceLine" id="cb29-109" title="109">                      </a>
<a class="sourceLine" id="cb29-110" title="110">                    u &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>numAgents</a>
<a class="sourceLine" id="cb29-111" title="111">                </a>
<a class="sourceLine" id="cb29-112" title="112">                    <span class="cf">for</span> (val <span class="cf">in</span> u) {</a>
<a class="sourceLine" id="cb29-113" title="113">                      </a>
<a class="sourceLine" id="cb29-114" title="114">                      <span class="cf">if</span>((.GlobalEnv<span class="op">$</span>pool[[val]]<span class="op">$</span>biostate <span class="op">!=</span><span class="st"> </span><span class="dv">8</span>) ){</a>
<a class="sourceLine" id="cb29-115" title="115">                </a>
<a class="sourceLine" id="cb29-116" title="116">                        <span class="cf">if</span>((.GlobalEnv<span class="op">$</span>pool[[val]]<span class="op">$</span>biostate <span class="op">!=</span><span class="st"> </span><span class="dv">7</span>)){</a>
<a class="sourceLine" id="cb29-117" title="117">                          x&lt;-u</a>
<a class="sourceLine" id="cb29-118" title="118">                          </a>
<a class="sourceLine" id="cb29-119" title="119">                        }</a>
<a class="sourceLine" id="cb29-120" title="120">                      }</a>
<a class="sourceLine" id="cb29-121" title="121">                     </a>
<a class="sourceLine" id="cb29-122" title="122">                    }    </a>
<a class="sourceLine" id="cb29-123" title="123">                    </a>
<a class="sourceLine" id="cb29-124" title="124">                    a &lt;-<span class="st"> </span><span class="kw">sample</span>(x, number_of_people_leave)</a>
<a class="sourceLine" id="cb29-125" title="125">                    </a>
<a class="sourceLine" id="cb29-126" title="126">                            </a>
<a class="sourceLine" id="cb29-127" title="127">                    <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(a)) {</a>
<a class="sourceLine" id="cb29-128" title="128">                      </a>
<a class="sourceLine" id="cb29-129" title="129">                      <span class="co">#print(a[i])</span></a>
<a class="sourceLine" id="cb29-130" title="130">                      x &lt;-<span class="st"> </span>a[i]</a>
<a class="sourceLine" id="cb29-131" title="131">                      .GlobalEnv<span class="op">$</span>pool[[x]] &lt;-<span class="st"> </span><span class="kw">setAgentState</span>( .GlobalEnv<span class="op">$</span>pool[[x]],<span class="dv">8</span>)</a>
<a class="sourceLine" id="cb29-132" title="132">          </a>
<a class="sourceLine" id="cb29-133" title="133">                      socialnetwork[x,] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb29-134" title="134">                      socialnetwork[,x] &lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb29-135" title="135">                    }                </a>
<a class="sourceLine" id="cb29-136" title="136">                           </a>
<a class="sourceLine" id="cb29-137" title="137">                  </a>
<a class="sourceLine" id="cb29-138" title="138">                  </a>
<a class="sourceLine" id="cb29-139" title="139">                 </a>
<a class="sourceLine" id="cb29-140" title="140">          }              </a>
<a class="sourceLine" id="cb29-141" title="141"></a>
<a class="sourceLine" id="cb29-142" title="142">          <span class="co"># if(day == (second_wave_day+5)){</span></a>
<a class="sourceLine" id="cb29-143" title="143">          <span class="co">#   </span></a>
<a class="sourceLine" id="cb29-144" title="144">          <span class="co">#   d &lt;- 1:numAgents</span></a>
<a class="sourceLine" id="cb29-145" title="145">          <span class="co">#   number_traveler_found</span></a>
<a class="sourceLine" id="cb29-146" title="146">          <span class="co">#   repeat{</span></a>
<a class="sourceLine" id="cb29-147" title="147">          <span class="co">#     statements...</span></a>
<a class="sourceLine" id="cb29-148" title="148">          <span class="co">#     if(condition){</span></a>
<a class="sourceLine" id="cb29-149" title="149">          <span class="co">#       break</span></a>
<a class="sourceLine" id="cb29-150" title="150">          <span class="co">#     }</span></a>
<a class="sourceLine" id="cb29-151" title="151">          <span class="co">#   }            </span></a>
<a class="sourceLine" id="cb29-152" title="152">          <span class="co">#   </span></a>
<a class="sourceLine" id="cb29-153" title="153">          <span class="co">#   </span></a>
<a class="sourceLine" id="cb29-154" title="154">          <span class="co">#   </span></a>
<a class="sourceLine" id="cb29-155" title="155">          <span class="co">#       x &lt;- 18</span></a>
<a class="sourceLine" id="cb29-156" title="156">          <span class="co">#       .GlobalEnv$pool[[x]] &lt;- setAgentState( .GlobalEnv$pool[[x]],8)</span></a>
<a class="sourceLine" id="cb29-157" title="157">          <span class="co"># </span></a>
<a class="sourceLine" id="cb29-158" title="158">          <span class="co">#       socialnetwork[x,] &lt;- 0</span></a>
<a class="sourceLine" id="cb29-159" title="159">          <span class="co">#       socialnetwork[,x]&lt;-0</span></a>
<a class="sourceLine" id="cb29-160" title="160">          <span class="co"># }</span></a>
<a class="sourceLine" id="cb29-161" title="161"></a>
<a class="sourceLine" id="cb29-162" title="162">        }</a>
<a class="sourceLine" id="cb29-163" title="163"></a>
<a class="sourceLine" id="cb29-164" title="164">      }</a>
<a class="sourceLine" id="cb29-165" title="165"></a>
<a class="sourceLine" id="cb29-166" title="166">      <span class="co">###################agent leaving ENd</span></a>
<a class="sourceLine" id="cb29-167" title="167">    </a>
<a class="sourceLine" id="cb29-168" title="168"></a>
<a class="sourceLine" id="cb29-169" title="169">          innetwork &lt;-<span class="st"> </span><span class="kw">sapply</span>(.GlobalEnv<span class="op">$</span>pool,<span class="cf">function</span>(y){<span class="op">!</span>(y<span class="op">$</span>biostate<span class="op">==</span><span class="dv">7</span><span class="op">||</span>y<span class="op">$</span>biostate<span class="op">==</span><span class="dv">8</span>)})</a>
<a class="sourceLine" id="cb29-170" title="170">  </a>
<a class="sourceLine" id="cb29-171" title="171">  <span class="co">##who are you going to talk to today.</span></a>
<a class="sourceLine" id="cb29-172" title="172">      sneezers &lt;-<span class="st"> </span><span class="kw">rep</span>((<span class="dv">1</span><span class="op">:</span>numAgents)[innetwork],<span class="dt">each=</span>numInteractions[day])</a>
<a class="sourceLine" id="cb29-173" title="173">      sneezedons &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>,<span class="kw">length</span>(sneezers))</a>
<a class="sourceLine" id="cb29-174" title="174">      </a>
<a class="sourceLine" id="cb29-175" title="175">      <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sneezers))</a>
<a class="sourceLine" id="cb29-176" title="176">        {</a>
<a class="sourceLine" id="cb29-177" title="177">        <span class="cf">if</span>(<span class="kw">runif</span>(<span class="dv">1</span>)<span class="op">&lt;</span>(<span class="dv">1</span><span class="op">-</span>sampleFromNetwork))</a>
<a class="sourceLine" id="cb29-178" title="178">        {</a>
<a class="sourceLine" id="cb29-179" title="179">    </a>
<a class="sourceLine" id="cb29-180" title="180">          sneezedons[i] &lt;-<span class="st"> </span><span class="kw">sample</span>((<span class="dv">1</span><span class="op">:</span>numAgents)[innetwork],<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb29-181" title="181">        }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb29-182" title="182">          </a>
<a class="sourceLine" id="cb29-183" title="183">          probs &lt;-<span class="st"> </span>socialnetwork[sneezers[i],]<span class="op">*</span><span class="st"> </span>innetwork</a>
<a class="sourceLine" id="cb29-184" title="184">          sneezedons[i] &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>numAgents,<span class="dt">prob=</span>probs,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb29-185" title="185">          </a>
<a class="sourceLine" id="cb29-186" title="186">        }</a>
<a class="sourceLine" id="cb29-187" title="187">       }</a>
<a class="sourceLine" id="cb29-188" title="188">      </a>
<a class="sourceLine" id="cb29-189" title="189">        </a>
<a class="sourceLine" id="cb29-190" title="190">    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sneezers))</a>
<a class="sourceLine" id="cb29-191" title="191">    {</a>
<a class="sourceLine" id="cb29-192" title="192">      </a>
<a class="sourceLine" id="cb29-193" title="193">      agent1 &lt;-<span class="st"> </span>.GlobalEnv<span class="op">$</span>pool[[ sneezers[i] ]]</a>
<a class="sourceLine" id="cb29-194" title="194">      agent2 &lt;-<span class="st"> </span>.GlobalEnv<span class="op">$</span>pool[[ sneezedons[i] ]]</a>
<a class="sourceLine" id="cb29-195" title="195">    </a>
<a class="sourceLine" id="cb29-196" title="196">      </a>
<a class="sourceLine" id="cb29-197" title="197">      <span class="co">##this constitutes the rules of infection.</span></a>
<a class="sourceLine" id="cb29-198" title="198">      <span class="cf">if</span>((agent1<span class="op">$</span>biostate<span class="op">==</span><span class="dv">2</span> <span class="op">||</span><span class="st"> </span>agent1<span class="op">$</span>biostate<span class="op">==</span><span class="dv">3</span> ) <span class="op">&amp;</span><span class="st"> </span>agent2<span class="op">$</span>biostate<span class="op">==</span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)<span class="op">&lt;</span>contagionProb)</a>
<a class="sourceLine" id="cb29-199" title="199">      {</a>
<a class="sourceLine" id="cb29-200" title="200">           .GlobalEnv<span class="op">$</span>pool[[ sneezedons[i] ]] &lt;-<span class="st"> </span><span class="kw">setAgentState</span>(agent2,<span class="dv">2</span>)<span class="co">##infect!</span></a>
<a class="sourceLine" id="cb29-201" title="201">      }</a>
<a class="sourceLine" id="cb29-202" title="202">        </a>
<a class="sourceLine" id="cb29-203" title="203">    }</a>
<a class="sourceLine" id="cb29-204" title="204">      <span class="co">##increment each agent 1-day.</span></a>
<a class="sourceLine" id="cb29-205" title="205">      <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>numAgents)</a>
<a class="sourceLine" id="cb29-206" title="206">      {</a>
<a class="sourceLine" id="cb29-207" title="207">         .GlobalEnv<span class="op">$</span>pool[[i]] &lt;-<span class="st"> </span><span class="kw">updateAgent</span>(.GlobalEnv<span class="op">$</span>pool[[i]])</a>
<a class="sourceLine" id="cb29-208" title="208">         </a>
<a class="sourceLine" id="cb29-209" title="209">         <span class="co">###keep track number of local population infection</span></a>
<a class="sourceLine" id="cb29-210" title="210">         </a>
<a class="sourceLine" id="cb29-211" title="211">           </a>
<a class="sourceLine" id="cb29-212" title="212">           <span class="cf">if</span>(.GlobalEnv<span class="op">$</span>pool[[i]][<span class="st">&quot;traveler&quot;</span>] <span class="op">==</span><span class="st"> </span><span class="dv">0</span> ){</a>
<a class="sourceLine" id="cb29-213" title="213">             <span class="cf">if</span>(.GlobalEnv<span class="op">$</span>pool[[i]][<span class="st">&quot;biostate&quot;</span>] <span class="op">==</span><span class="st"> </span><span class="dv">2</span>){</a>
<a class="sourceLine" id="cb29-214" title="214">               <span class="cf">if</span>(.GlobalEnv<span class="op">$</span>pool[[i]][<span class="st">&quot;is_infected&quot;</span>] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>){         </a>
<a class="sourceLine" id="cb29-215" title="215">                 local_population_infection_number_local_variable &lt;-local_population_infection_number_local_variable<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb29-216" title="216">                .GlobalEnv<span class="op">$</span>pool[[i]] &lt;-<span class="st"> </span><span class="kw">setAgentStatusInfected</span>( .GlobalEnv<span class="op">$</span>pool[[i]],<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb29-217" title="217">               }</a>
<a class="sourceLine" id="cb29-218" title="218">               </a>
<a class="sourceLine" id="cb29-219" title="219">             }</a>
<a class="sourceLine" id="cb29-220" title="220">            </a>
<a class="sourceLine" id="cb29-221" title="221">           </a>
<a class="sourceLine" id="cb29-222" title="222">         }         </a>
<a class="sourceLine" id="cb29-223" title="223">           <span class="cf">if</span>(.GlobalEnv<span class="op">$</span>pool[[i]][<span class="st">&quot;traveler&quot;</span>] <span class="op">==</span><span class="st"> </span><span class="dv">1</span> ){</a>
<a class="sourceLine" id="cb29-224" title="224">             <span class="cf">if</span>(.GlobalEnv<span class="op">$</span>pool[[i]][<span class="st">&quot;biostate&quot;</span>] <span class="op">==</span><span class="st"> </span><span class="dv">2</span>){</a>
<a class="sourceLine" id="cb29-225" title="225">               <span class="cf">if</span>(.GlobalEnv<span class="op">$</span>pool[[i]][<span class="st">&quot;is_infected&quot;</span>] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>){         </a>
<a class="sourceLine" id="cb29-226" title="226">                 traveler_infection_number_local_variable &lt;-traveler_infection_number_local_variable<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb29-227" title="227">                .GlobalEnv<span class="op">$</span>pool[[i]] &lt;-<span class="st"> </span><span class="kw">setAgentStatusInfected</span>( .GlobalEnv<span class="op">$</span>pool[[i]],<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb29-228" title="228">               }</a>
<a class="sourceLine" id="cb29-229" title="229">               </a>
<a class="sourceLine" id="cb29-230" title="230">             }</a>
<a class="sourceLine" id="cb29-231" title="231">            </a>
<a class="sourceLine" id="cb29-232" title="232">           </a>
<a class="sourceLine" id="cb29-233" title="233">         }            </a>
<a class="sourceLine" id="cb29-234" title="234">         </a>
<a class="sourceLine" id="cb29-235" title="235">         </a>
<a class="sourceLine" id="cb29-236" title="236">      }</a>
<a class="sourceLine" id="cb29-237" title="237">    </a>
<a class="sourceLine" id="cb29-238" title="238">      states &lt;-<span class="st"> </span><span class="kw">sapply</span>(.GlobalEnv<span class="op">$</span>pool,<span class="dt">FUN=</span><span class="cf">function</span>(x){x<span class="op">$</span>biostate})</a>
<a class="sourceLine" id="cb29-239" title="239">      distrib &lt;-<span class="st"> </span><span class="kw">table</span>(<span class="kw">factor</span>(states,<span class="dt">levels=</span><span class="dv">1</span><span class="op">:</span>STATES))</a>
<a class="sourceLine" id="cb29-240" title="240">      disthistory[day,] &lt;-<span class="st"> </span>distrib</a>
<a class="sourceLine" id="cb29-241" title="241">     <span class="co"># print(disthistory[day,])</span></a>
<a class="sourceLine" id="cb29-242" title="242">      </a>
<a class="sourceLine" id="cb29-243" title="243">      </a>
<a class="sourceLine" id="cb29-244" title="244">     </a>
<a class="sourceLine" id="cb29-245" title="245">  </a>
<a class="sourceLine" id="cb29-246" title="246">      </a>
<a class="sourceLine" id="cb29-247" title="247">       <span class="co">#####################################</span></a>
<a class="sourceLine" id="cb29-248" title="248">      <span class="co">############################</span></a>
<a class="sourceLine" id="cb29-249" title="249">      <span class="co">##################################</span></a>
<a class="sourceLine" id="cb29-250" title="250">      <span class="co">################</span></a>
<a class="sourceLine" id="cb29-251" title="251">      <span class="co">################################   </span></a>
<a class="sourceLine" id="cb29-252" title="252">      <span class="co">####################Adding New agents as travelers in the network</span></a>
<a class="sourceLine" id="cb29-253" title="253">      </a>
<a class="sourceLine" id="cb29-254" title="254">      <span class="co">#traveler_interval_day &lt;-sample(c(3,2,5),1)</span></a>
<a class="sourceLine" id="cb29-255" title="255">      </a>
<a class="sourceLine" id="cb29-256" title="256">     <span class="co"># traveler_increase &lt;- sample(c(0,1),1)</span></a>
<a class="sourceLine" id="cb29-257" title="257">     </a>
<a class="sourceLine" id="cb29-258" title="258">      </a>
<a class="sourceLine" id="cb29-259" title="259">    </a>
<a class="sourceLine" id="cb29-260" title="260">      <span class="cf">if</span>(traveler_increase <span class="op">==</span><span class="st"> </span><span class="dv">0</span>){</a>
<a class="sourceLine" id="cb29-261" title="261">        <span class="cf">if</span>(day <span class="op">==</span><span class="st"> </span>second_wave_day){</a>
<a class="sourceLine" id="cb29-262" title="262">          </a>
<a class="sourceLine" id="cb29-263" title="263">          <span class="cf">if</span>(enable_second_wave <span class="op">==</span><span class="st"> </span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb29-264" title="264">            traveler_percentage_mean &lt;-<span class="st"> </span><span class="kw">as.integer</span>(traveler_percentage_ceiling<span class="op">/</span><span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb29-265" title="265">            </a>
<a class="sourceLine" id="cb29-266" title="266">             </a>
<a class="sourceLine" id="cb29-267" title="267">          }</a>
<a class="sourceLine" id="cb29-268" title="268">          </a>
<a class="sourceLine" id="cb29-269" title="269">          </a>
<a class="sourceLine" id="cb29-270" title="270">        }</a>
<a class="sourceLine" id="cb29-271" title="271">      }</a>
<a class="sourceLine" id="cb29-272" title="272">      <span class="co">##travel restriction on</span></a>
<a class="sourceLine" id="cb29-273" title="273">  </a>
<a class="sourceLine" id="cb29-274" title="274">      </a>
<a class="sourceLine" id="cb29-275" title="275">      </a>
<a class="sourceLine" id="cb29-276" title="276">      <span class="co">###if second wave already happned due to premature removal of travel ban. traveler will come in future days</span></a>
<a class="sourceLine" id="cb29-277" title="277">      <span class="cf">if</span>((enable_second_wave <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">&amp;&amp;</span><span class="st"> </span>(day <span class="op">==</span><span class="st"> </span>second_wave_day)){</a>
<a class="sourceLine" id="cb29-278" title="278">        </a>
<a class="sourceLine" id="cb29-279" title="279">        enable_outside_travel_restriction &lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb29-280" title="280">        </a>
<a class="sourceLine" id="cb29-281" title="281">      }</a>
<a class="sourceLine" id="cb29-282" title="282">      <span class="cf">else</span> <span class="cf">if</span>((enable_second_wave <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">&amp;&amp;</span><span class="st"> </span>(day <span class="op">&gt;</span><span class="st"> </span>second_wave_day)){</a>
<a class="sourceLine" id="cb29-283" title="283">        </a>
<a class="sourceLine" id="cb29-284" title="284">        enable_outside_travel_restriction &lt;-<span class="dv">0</span> <span class="co">###if we do not want to close down the travel after second wave</span></a>
<a class="sourceLine" id="cb29-285" title="285">      }</a>
<a class="sourceLine" id="cb29-286" title="286">      <span class="cf">else</span> <span class="cf">if</span>(enable_outside_travel_restriction_day <span class="op">==</span><span class="st"> </span><span class="dv">0</span>){</a>
<a class="sourceLine" id="cb29-287" title="287">        </a>
<a class="sourceLine" id="cb29-288" title="288">         enable_outside_travel_restriction &lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb29-289" title="289">         </a>
<a class="sourceLine" id="cb29-290" title="290">      }<span class="cf">else</span> <span class="cf">if</span>(enable_outside_travel_restriction_day <span class="op">==</span><span class="st"> </span>day){</a>
<a class="sourceLine" id="cb29-291" title="291">         enable_outside_travel_restriction &lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb29-292" title="292">        </a>
<a class="sourceLine" id="cb29-293" title="293">      }<span class="cf">else</span> <span class="cf">if</span>(enable_outside_travel_restriction <span class="op">==</span><span class="st"> </span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb29-294" title="294">        </a>
<a class="sourceLine" id="cb29-295" title="295">        enable_outside_travel_restriction &lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb29-296" title="296">        </a>
<a class="sourceLine" id="cb29-297" title="297">      }</a>
<a class="sourceLine" id="cb29-298" title="298">      <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb29-299" title="299">        </a>
<a class="sourceLine" id="cb29-300" title="300">        enable_outside_travel_restriction &lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb29-301" title="301">        </a>
<a class="sourceLine" id="cb29-302" title="302">      }</a>
<a class="sourceLine" id="cb29-303" title="303">      </a>
<a class="sourceLine" id="cb29-304" title="304">      </a>
<a class="sourceLine" id="cb29-305" title="305"></a>
<a class="sourceLine" id="cb29-306" title="306">      </a>
<a class="sourceLine" id="cb29-307" title="307">  </a>
<a class="sourceLine" id="cb29-308" title="308">      <span class="co">####</span></a>
<a class="sourceLine" id="cb29-309" title="309">      <span class="cf">if</span>(((<span class="op">!</span>(day <span class="op">%%</span><span class="st"> </span>traveler_interval_day)) <span class="op">||</span></a>
<a class="sourceLine" id="cb29-310" title="310"><span class="st">           </span>(day<span class="op">==</span>second_wave_day)) <span class="op">&amp;&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-311" title="311"><span class="st">           </span>(enable_outside_travel_restriction<span class="op">==</span><span class="dv">0</span>)){</a>
<a class="sourceLine" id="cb29-312" title="312">        </a>
<a class="sourceLine" id="cb29-313" title="313">            <span class="cf">if</span>(traveler_percentage_mean <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb29-314" title="314"></a>
<a class="sourceLine" id="cb29-315" title="315">              traveler_percentage_mean =<span class="st">  </span><span class="kw">as.integer</span>(traveler_percentage_ceiling<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb29-316" title="316">            }</a>
<a class="sourceLine" id="cb29-317" title="317">            <span class="cf">else</span> <span class="cf">if</span>(traveler_percentage_mean<span class="op">&gt;</span>traveler_percentage_ceiling){</a>
<a class="sourceLine" id="cb29-318" title="318">              </a>
<a class="sourceLine" id="cb29-319" title="319">              traveler_percentage_mean =<span class="st"> </span>traveler_percentage_ceiling</a>
<a class="sourceLine" id="cb29-320" title="320">            }</a>
<a class="sourceLine" id="cb29-321" title="321">     </a>
<a class="sourceLine" id="cb29-322" title="322">        </a>
<a class="sourceLine" id="cb29-323" title="323">          <span class="cf">if</span>(traveler_percentage_mean <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>){</a>
<a class="sourceLine" id="cb29-324" title="324">            number_of_traveler &lt;-<span class="kw">as.integer</span>((traveler_percentage_mean<span class="op">/</span><span class="dv">100</span>) <span class="op">*</span><span class="st"> </span>numAgents_initial)</a>
<a class="sourceLine" id="cb29-325" title="325">            current_number_traveler_remaining &lt;-<span class="st"> </span>number_of_traveler</a>
<a class="sourceLine" id="cb29-326" title="326">            <span class="cf">if</span>(traveler_increase <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb29-327" title="327"></a>
<a class="sourceLine" id="cb29-328" title="328">              traveler_percentage_mean =<span class="st"> </span>traveler_percentage_mean <span class="op">-</span><span class="st"> </span>boundary_of_traveler_change</a>
<a class="sourceLine" id="cb29-329" title="329"></a>
<a class="sourceLine" id="cb29-330" title="330">            }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb29-331" title="331"></a>
<a class="sourceLine" id="cb29-332" title="332">              traveler_percentage_mean =<span class="st"> </span>traveler_percentage_mean <span class="op">+</span><span class="st"> </span>boundary_of_traveler_change</a>
<a class="sourceLine" id="cb29-333" title="333"></a>
<a class="sourceLine" id="cb29-334" title="334">            </a>
<a class="sourceLine" id="cb29-335" title="335"></a>
<a class="sourceLine" id="cb29-336" title="336">            }</a>
<a class="sourceLine" id="cb29-337" title="337">            <span class="co">###enabling travel restruition after second wave</span></a>
<a class="sourceLine" id="cb29-338" title="338">            <span class="cf">if</span>(enable_second_wave <span class="op">==</span><span class="st"> </span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb29-339" title="339">              <span class="cf">if</span>((day<span class="op">==</span>second_wave_day) <span class="op">&amp;&amp;</span><span class="st"> </span>(enable_outside_travel_restriction_day <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>)){</a>
<a class="sourceLine" id="cb29-340" title="340">                </a>
<a class="sourceLine" id="cb29-341" title="341">                enable_outside_travel_restriction&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb29-342" title="342">              }</a>
<a class="sourceLine" id="cb29-343" title="343">            }</a>
<a class="sourceLine" id="cb29-344" title="344">            </a>
<a class="sourceLine" id="cb29-345" title="345">            <span class="co">###for evenly distributing travel to network I run a do while loop</span></a>
<a class="sourceLine" id="cb29-346" title="346">            <span class="co">#print(&quot;number_of_traveler&quot;)</span></a>
<a class="sourceLine" id="cb29-347" title="347">            <span class="co">#print(number_of_traveler)</span></a>
<a class="sourceLine" id="cb29-348" title="348">            <span class="co">#print(&quot;-----------------------start-------------------&quot;)</span></a>
<a class="sourceLine" id="cb29-349" title="349">            <span class="cf">repeat</span>{</a>
<a class="sourceLine" id="cb29-350" title="350">              current_number_traveler &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>),<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb29-351" title="351">                </a>
<a class="sourceLine" id="cb29-352" title="352">                <span class="co">#</span></a>
<a class="sourceLine" id="cb29-353" title="353">  </a>
<a class="sourceLine" id="cb29-354" title="354">              </a>
<a class="sourceLine" id="cb29-355" title="355">              <span class="cf">if</span>(current_number_traveler<span class="op">&gt;</span>current_number_traveler_remaining){</a>
<a class="sourceLine" id="cb29-356" title="356">                </a>
<a class="sourceLine" id="cb29-357" title="357">                current_number_traveler &lt;-<span class="st"> </span>current_number_traveler_remaining</a>
<a class="sourceLine" id="cb29-358" title="358">              }</a>
<a class="sourceLine" id="cb29-359" title="359">              </a>
<a class="sourceLine" id="cb29-360" title="360">             <span class="co"># print(current_number_traveler)</span></a>
<a class="sourceLine" id="cb29-361" title="361">  </a>
<a class="sourceLine" id="cb29-362" title="362">              </a>
<a class="sourceLine" id="cb29-363" title="363">              <span class="cf">if</span>(current_number_traveler <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb29-364" title="364">              {</a>
<a class="sourceLine" id="cb29-365" title="365">                starting_numagents &lt;-<span class="st"> </span>numAgents <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb29-366" title="366">                ending_numagent &lt;-<span class="st"> </span>numAgents<span class="op">+</span>current_number_traveler</a>
<a class="sourceLine" id="cb29-367" title="367">                </a>
<a class="sourceLine" id="cb29-368" title="368">                <span class="co">####connection_number indicates new agent connected how many number of previous agents, currently it is a number between 1-3</span></a>
<a class="sourceLine" id="cb29-369" title="369">                </a>
<a class="sourceLine" id="cb29-370" title="370">                socialnetwork &lt;-<span class="st"> </span><span class="kw">addAgentToNetwork</span>(<span class="dt">numAgents =</span> current_number_traveler,</a>
<a class="sourceLine" id="cb29-371" title="371">                                                   <span class="dt">prev_network =</span> socialnetwork,</a>
<a class="sourceLine" id="cb29-372" title="372">                                                   <span class="dt">connection_number =</span> connection_number,</a>
<a class="sourceLine" id="cb29-373" title="373">                                                   <span class="dt">self_connected=</span><span class="dv">1</span>,.GlobalEnv<span class="op">$</span>pool)</a>
<a class="sourceLine" id="cb29-374" title="374">               <span class="co"># print(socialnetwork)</span></a>
<a class="sourceLine" id="cb29-375" title="375">                </a>
<a class="sourceLine" id="cb29-376" title="376">                newxy &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(current_number_traveler,<span class="dt">mean=</span>xval,<span class="dt">sd=</span>sd),</a>
<a class="sourceLine" id="cb29-377" title="377">                               <span class="kw">rnorm</span>(current_number_traveler, <span class="dt">mean=</span>yval,<span class="dt">sd=</span>sd))</a>
<a class="sourceLine" id="cb29-378" title="378">                </a>
<a class="sourceLine" id="cb29-379" title="379">                cc &lt;-<span class="st"> </span><span class="kw">rbind</span>(cc,newxy)</a>
<a class="sourceLine" id="cb29-380" title="380">                <span class="cf">for</span>(i <span class="cf">in</span> starting_numagents<span class="op">:</span>ending_numagent)</a>
<a class="sourceLine" id="cb29-381" title="381">                  {</a>
<a class="sourceLine" id="cb29-382" title="382">                    <span class="co">###printing to see how are travelers</span></a>
<a class="sourceLine" id="cb29-383" title="383">                    <span class="co"># print(&quot;adding&quot;)</span></a>
<a class="sourceLine" id="cb29-384" title="384">                     .GlobalEnv<span class="op">$</span>pool[[i]] &lt;&lt;-<span class="st"> </span><span class="kw">makeAgent</span>(<span class="dt">psychstate=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb29-385" title="385">                                            <span class="dt">biostate=</span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">6</span>),</a>
<a class="sourceLine" id="cb29-386" title="386">                                            <span class="dt">p=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>naturalImmunity, naturalImmunity),<span class="dv">1</span>),</a>
<a class="sourceLine" id="cb29-387" title="387">                                            <span class="dt">traveler =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb29-388" title="388">                   <span class="co"># print(&quot;added&quot;)</span></a>
<a class="sourceLine" id="cb29-389" title="389">                    <span class="co">################to make randomize infect -&gt; traveler</span></a>
<a class="sourceLine" id="cb29-390" title="390">                     </a>
<a class="sourceLine" id="cb29-391" title="391">                     will_be_infected &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb29-392" title="392">                     </a>
<a class="sourceLine" id="cb29-393" title="393">                    </a>
<a class="sourceLine" id="cb29-394" title="394">                     </a>
<a class="sourceLine" id="cb29-395" title="395">                    <span class="co"># print(paste(&quot;infecting&quot;,i))</span></a>
<a class="sourceLine" id="cb29-396" title="396">                     <span class="co">#####Tell shane about if setAgentState is 2, then number of local remains ok, but if state is 1 then it changes</span></a>
<a class="sourceLine" id="cb29-397" title="397">                     <span class="cf">if</span>(will_affect_traveler <span class="op">==</span><span class="st"> </span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb29-398" title="398">                       <span class="co">#print(&quot;poit a&quot;)</span></a>
<a class="sourceLine" id="cb29-399" title="399">                       tmp &lt;-<span class="st">  </span><span class="kw">setAgentState</span>(.GlobalEnv<span class="op">$</span>pool[[i]],<span class="dv">2</span>) <span class="co">##infect this person</span></a>
<a class="sourceLine" id="cb29-400" title="400">                       <span class="co">#print(&quot;point b&quot;)</span></a>
<a class="sourceLine" id="cb29-401" title="401">                       .GlobalEnv<span class="op">$</span>pool[[i]] &lt;&lt;-tmp</a>
<a class="sourceLine" id="cb29-402" title="402">                       </a>
<a class="sourceLine" id="cb29-403" title="403">                     }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb29-404" title="404">          </a>
<a class="sourceLine" id="cb29-405" title="405">                      <span class="co"># print(&quot;point b1&quot;)</span></a>
<a class="sourceLine" id="cb29-406" title="406">                      <span class="co"># tmp &lt;- setAgentState(.GlobalEnv$pool[[i]],1) ##do not infect this person</span></a>
<a class="sourceLine" id="cb29-407" title="407">                      <span class="co"># print(&quot;point b2&quot;)</span></a>
<a class="sourceLine" id="cb29-408" title="408">                      <span class="co"># .GlobalEnv$pool[[i]] &lt;&lt;- tmp</span></a>
<a class="sourceLine" id="cb29-409" title="409">                      <span class="co"># print(&quot;point b3&quot;)</span></a>
<a class="sourceLine" id="cb29-410" title="410">                     }</a>
<a class="sourceLine" id="cb29-411" title="411">                    <span class="co"># print(&quot;infected&quot;)</span></a>
<a class="sourceLine" id="cb29-412" title="412">                     </a>
<a class="sourceLine" id="cb29-413" title="413">                     <span class="co"># </span></a>
<a class="sourceLine" id="cb29-414" title="414">                     </a>
<a class="sourceLine" id="cb29-415" title="415">                     </a>
<a class="sourceLine" id="cb29-416" title="416">                 </a>
<a class="sourceLine" id="cb29-417" title="417">                     </a>
<a class="sourceLine" id="cb29-418" title="418">                     </a>
<a class="sourceLine" id="cb29-419" title="419">                }</a>
<a class="sourceLine" id="cb29-420" title="420">                numAgents &lt;-<span class="st"> </span>ending_numagent</a>
<a class="sourceLine" id="cb29-421" title="421">                need_to_update_graph_cord &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb29-422" title="422">              }</a>
<a class="sourceLine" id="cb29-423" title="423">              current_number_traveler_remaining &lt;-<span class="st"> </span>current_number_traveler_remaining<span class="op">-</span>current_number_traveler</a>
<a class="sourceLine" id="cb29-424" title="424">              <span class="cf">if</span>(current_number_traveler_remaining <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb29-425" title="425">                 <span class="co">#print(&quot;-----------------------end-------------------&quot;)</span></a>
<a class="sourceLine" id="cb29-426" title="426">                <span class="cf">break</span></a>
<a class="sourceLine" id="cb29-427" title="427">              }</a>
<a class="sourceLine" id="cb29-428" title="428">              </a>
<a class="sourceLine" id="cb29-429" title="429">            }</a>
<a class="sourceLine" id="cb29-430" title="430">        }</a>
<a class="sourceLine" id="cb29-431" title="431">      }</a>
<a class="sourceLine" id="cb29-432" title="432">      </a>
<a class="sourceLine" id="cb29-433" title="433">     <span class="cf">if</span>(plotNetwork)</a>
<a class="sourceLine" id="cb29-434" title="434">     {</a>
<a class="sourceLine" id="cb29-435" title="435">        <span class="co">## print(1)</span></a>
<a class="sourceLine" id="cb29-436" title="436">       </a>
<a class="sourceLine" id="cb29-437" title="437">       <span class="co">##show this to SHane</span></a>
<a class="sourceLine" id="cb29-438" title="438">        <span class="co"># cc &lt;-mygplot(coord=NULL,socialnetwork,rep(1,nrow(socialnetwork)),main=&quot;Initial state&quot;)</span></a>
<a class="sourceLine" id="cb29-439" title="439">        <span class="co"># mygplot(coord=NULL,socialnetwork,states,main=paste(&quot;Day&quot;,day))</span></a>
<a class="sourceLine" id="cb29-440" title="440">       </a>
<a class="sourceLine" id="cb29-441" title="441">       <span class="cf">if</span>(need_to_update_graph_cord){</a>
<a class="sourceLine" id="cb29-442" title="442">        <span class="co"># print(&quot;UPDATE NEEDED&quot;)</span></a>
<a class="sourceLine" id="cb29-443" title="443">        </a>
<a class="sourceLine" id="cb29-444" title="444">         <span class="kw">mygplot_updated</span>(cc,socialnetwork,states,<span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;Day&quot;</span>,day, <span class="st">&quot; &quot;</span>, <span class="st">&quot;Traveler Added&quot;</span>, number_of_traveler))</a>
<a class="sourceLine" id="cb29-445" title="445">        </a>
<a class="sourceLine" id="cb29-446" title="446">         </a>
<a class="sourceLine" id="cb29-447" title="447">       }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb29-448" title="448">         </a>
<a class="sourceLine" id="cb29-449" title="449">         <span class="kw">mygplot_updated</span>(cc,socialnetwork,states,<span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;Day&quot;</span>,day))</a>
<a class="sourceLine" id="cb29-450" title="450">       }</a>
<a class="sourceLine" id="cb29-451" title="451">        need_to_update_graph_cord &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb29-452" title="452">       </a>
<a class="sourceLine" id="cb29-453" title="453">        </a>
<a class="sourceLine" id="cb29-454" title="454">         </a>
<a class="sourceLine" id="cb29-455" title="455">         </a>
<a class="sourceLine" id="cb29-456" title="456">         </a>
<a class="sourceLine" id="cb29-457" title="457">  </a>
<a class="sourceLine" id="cb29-458" title="458">     }    </a>
<a class="sourceLine" id="cb29-459" title="459">      </a>
<a class="sourceLine" id="cb29-460" title="460">      </a>
<a class="sourceLine" id="cb29-461" title="461">  <span class="co">###vary week for travel restriction</span></a>
<a class="sourceLine" id="cb29-462" title="462">     </a>
<a class="sourceLine" id="cb29-463" title="463">    </a>
<a class="sourceLine" id="cb29-464" title="464">      </a>
<a class="sourceLine" id="cb29-465" title="465">         </a>
<a class="sourceLine" id="cb29-466" title="466">  }</a>
<a class="sourceLine" id="cb29-467" title="467"></a>
<a class="sourceLine" id="cb29-468" title="468">  total_local &lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb29-469" title="469">  affected_locals &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb29-470" title="470">  affected_travelers &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb29-471" title="471">  local_death &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb29-472" title="472">  total_traveler &lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb29-473" title="473">  traveler_death &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb29-474" title="474">  ok_travler &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb29-475" title="475">  ok_local&lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb29-476" title="476">  <span class="co">#print(disthistory)</span></a>
<a class="sourceLine" id="cb29-477" title="477">     </a>
<a class="sourceLine" id="cb29-478" title="478">   <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>numAgents)</a>
<a class="sourceLine" id="cb29-479" title="479">   {</a>
<a class="sourceLine" id="cb29-480" title="480">     </a>
<a class="sourceLine" id="cb29-481" title="481">     <span class="cf">if</span>(pool[[i]][<span class="st">&quot;traveler&quot;</span>] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>){</a>
<a class="sourceLine" id="cb29-482" title="482">       </a>
<a class="sourceLine" id="cb29-483" title="483">       <span class="co">#print(i)</span></a>
<a class="sourceLine" id="cb29-484" title="484">       </a>
<a class="sourceLine" id="cb29-485" title="485">       total_local &lt;-total_local<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb29-486" title="486">       <span class="cf">if</span>(pool[[i]][<span class="st">&quot;biostate&quot;</span>] <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">||</span><span class="st"> </span>pool[[i]][<span class="st">&quot;biostate&quot;</span>] <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">||</span><span class="st"> </span>pool[[i]][<span class="st">&quot;biostate&quot;</span>] <span class="op">==</span><span class="st"> </span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb29-487" title="487">         {</a>
<a class="sourceLine" id="cb29-488" title="488">           affected_locals &lt;-affected_locals <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb29-489" title="489">       }</a>
<a class="sourceLine" id="cb29-490" title="490">       <span class="cf">else</span> <span class="cf">if</span>(pool[[i]][<span class="st">&quot;biostate&quot;</span>] <span class="op">==</span><span class="st"> </span><span class="dv">7</span>){</a>
<a class="sourceLine" id="cb29-491" title="491">         </a>
<a class="sourceLine" id="cb29-492" title="492">         local_death &lt;-local_death<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb29-493" title="493">       }</a>
<a class="sourceLine" id="cb29-494" title="494">       <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb29-495" title="495">         </a>
<a class="sourceLine" id="cb29-496" title="496">         ok_local &lt;-<span class="st"> </span>ok_local<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb29-497" title="497">       }</a>
<a class="sourceLine" id="cb29-498" title="498">       </a>
<a class="sourceLine" id="cb29-499" title="499">     }</a>
<a class="sourceLine" id="cb29-500" title="500">     <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb29-501" title="501">       total_traveler &lt;-<span class="st"> </span>total_traveler<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb29-502" title="502">       <span class="cf">if</span>(pool[[i]][<span class="st">&quot;biostate&quot;</span>] <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">||</span><span class="st"> </span>pool[[i]][<span class="st">&quot;biostate&quot;</span>] <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">||</span><span class="st"> </span>pool[[i]][<span class="st">&quot;biostate&quot;</span>] <span class="op">==</span><span class="st"> </span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb29-503" title="503">         {</a>
<a class="sourceLine" id="cb29-504" title="504">           affected_travelers &lt;-affected_travelers <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb29-505" title="505">       }</a>
<a class="sourceLine" id="cb29-506" title="506">       <span class="cf">else</span> <span class="cf">if</span>(pool[[i]][<span class="st">&quot;biostate&quot;</span>] <span class="op">==</span><span class="st"> </span><span class="dv">7</span>){</a>
<a class="sourceLine" id="cb29-507" title="507">         </a>
<a class="sourceLine" id="cb29-508" title="508">         traveler_death &lt;-traveler_death<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb29-509" title="509">       }  </a>
<a class="sourceLine" id="cb29-510" title="510">       <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb29-511" title="511">         </a>
<a class="sourceLine" id="cb29-512" title="512">         ok_travler &lt;-<span class="st"> </span>ok_travler<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb29-513" title="513">       }       </a>
<a class="sourceLine" id="cb29-514" title="514">       </a>
<a class="sourceLine" id="cb29-515" title="515">       </a>
<a class="sourceLine" id="cb29-516" title="516">     }</a>
<a class="sourceLine" id="cb29-517" title="517">   }</a>
<a class="sourceLine" id="cb29-518" title="518">  </a>
<a class="sourceLine" id="cb29-519" title="519">    <span class="co">#.GlobalEnv$pool &lt;- list.remove(.GlobalEnv$pool, 1)</span></a>
<a class="sourceLine" id="cb29-520" title="520">    <span class="co">#print(.GlobalEnv$pool)</span></a>
<a class="sourceLine" id="cb29-521" title="521">  <span class="kw">print</span>(<span class="st">&quot;TOTAL&quot;</span>)</a>
<a class="sourceLine" id="cb29-522" title="522">  <span class="kw">print</span>(numAgents)</a>
<a class="sourceLine" id="cb29-523" title="523">  <span class="kw">print</span>(<span class="st">&quot;Total Local&quot;</span>)</a>
<a class="sourceLine" id="cb29-524" title="524">  <span class="kw">print</span>(total_local)</a>
<a class="sourceLine" id="cb29-525" title="525">  <span class="co"># print(&quot;Local Recovered/Not affected&quot;)</span></a>
<a class="sourceLine" id="cb29-526" title="526">  <span class="co"># print(ok_local)</span></a>
<a class="sourceLine" id="cb29-527" title="527">  <span class="co"># print(&quot;Local Affected&quot;)</span></a>
<a class="sourceLine" id="cb29-528" title="528">  <span class="co"># print(affected_locals)</span></a>
<a class="sourceLine" id="cb29-529" title="529">  <span class="kw">print</span>(<span class="st">&quot;Local Death&quot;</span>)</a>
<a class="sourceLine" id="cb29-530" title="530">  <span class="kw">print</span>(local_death)</a>
<a class="sourceLine" id="cb29-531" title="531">  <span class="kw">print</span>(<span class="st">&quot;-----&quot;</span>)</a>
<a class="sourceLine" id="cb29-532" title="532">  <span class="kw">print</span>(<span class="st">&quot;Total Traveler&quot;</span>)</a>
<a class="sourceLine" id="cb29-533" title="533">  <span class="kw">print</span>(total_traveler)  </a>
<a class="sourceLine" id="cb29-534" title="534">  </a>
<a class="sourceLine" id="cb29-535" title="535">  <span class="co"># print(&quot;Traveler Recovered/Not affected&quot;)</span></a>
<a class="sourceLine" id="cb29-536" title="536">  <span class="co"># print(ok_travler)</span></a>
<a class="sourceLine" id="cb29-537" title="537">  <span class="co"># print(&quot;Traveler Affected&quot;)</span></a>
<a class="sourceLine" id="cb29-538" title="538">  <span class="co"># print(affected_travelers)</span></a>
<a class="sourceLine" id="cb29-539" title="539">  <span class="kw">print</span>(<span class="st">&quot;Traveler Death&quot;</span>)</a>
<a class="sourceLine" id="cb29-540" title="540">  <span class="kw">print</span>(traveler_death)</a>
<a class="sourceLine" id="cb29-541" title="541">  </a>
<a class="sourceLine" id="cb29-542" title="542">  </a>
<a class="sourceLine" id="cb29-543" title="543">  <span class="kw">print</span>(<span class="st">&quot;Local infected at somepoint&quot;</span>)</a>
<a class="sourceLine" id="cb29-544" title="544">  <span class="kw">print</span>(local_population_infection_number_local_variable)</a>
<a class="sourceLine" id="cb29-545" title="545">  <span class="kw">print</span>(<span class="st">&quot;Traveler infected at somepoint&quot;</span>)</a>
<a class="sourceLine" id="cb29-546" title="546">  <span class="kw">print</span>(traveler_infection_number_local_variable) </a>
<a class="sourceLine" id="cb29-547" title="547">  <span class="kw">print</span>(<span class="st">&quot;Total infected at somepoint&quot;</span>)</a>
<a class="sourceLine" id="cb29-548" title="548">  <span class="kw">print</span>(traveler_infection_number_local_variable <span class="op">+</span><span class="st"> </span>local_population_infection_number_local_variable) </a>
<a class="sourceLine" id="cb29-549" title="549">  </a>
<a class="sourceLine" id="cb29-550" title="550"> <span class="co"># print(traveler_percentage_mean)</span></a>
<a class="sourceLine" id="cb29-551" title="551">  </a>
<a class="sourceLine" id="cb29-552" title="552"></a>
<a class="sourceLine" id="cb29-553" title="553">  </a>
<a class="sourceLine" id="cb29-554" title="554"></a>
<a class="sourceLine" id="cb29-555" title="555"></a>
<a class="sourceLine" id="cb29-556" title="556">  </a>
<a class="sourceLine" id="cb29-557" title="557">  <span class="kw">return</span>(disthistory)</a>
<a class="sourceLine" id="cb29-558" title="558">  </a>
<a class="sourceLine" id="cb29-559" title="559">  </a>
<a class="sourceLine" id="cb29-560" title="560"></a>
<a class="sourceLine" id="cb29-561" title="561"></a>
<a class="sourceLine" id="cb29-562" title="562"> </a>
<a class="sourceLine" id="cb29-563" title="563">}</a></code></pre></div>
<p>We will run the model for a community of 700 local agents, for 100 days</p>
<p>The simulations will be divided into major parts. Interactions among agents will be one-third of normal interactions during travel ban</p>
<p>In the first part, we will see how travlers affect the local populations when no from the local populaton if infeceted.</p>
</div>
</div>
</div>
<div id="initial-simulation" class="section level2">
<h2>Initial simulation</h2>
<p>For this first simulation, No locals are affected with a strain from beginning.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">  numAgents_initial &lt;&lt;-<span class="st"> </span><span class="dv">700</span></a>
<a class="sourceLine" id="cb30-2" title="2">  naturalImmunity &lt;-<span class="st"> </span><span class="fl">.01</span></a>
<a class="sourceLine" id="cb30-3" title="3">  socialnetwork &lt;-<span class="kw">makeNetwork</span>(numAgents_initial,<span class="dt">numsets=</span><span class="dv">1</span>,<span class="dt">power=</span>.<span class="dv">5</span>,<span class="dt">steps=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb30-4" title="4">  local_population_infection_number &lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb30-5" title="5">  </a>
<a class="sourceLine" id="cb30-6" title="6">  infect_local &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb30-7" title="7">  </a>
<a class="sourceLine" id="cb30-8" title="8">  original_network_of_agents &lt;&lt;-<span class="st"> </span>socialnetwork</a>
<a class="sourceLine" id="cb30-9" title="9">  </a>
<a class="sourceLine" id="cb30-10" title="10">  .GlobalEnv<span class="op">$</span>pool &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb30-11" title="11">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>numAgents_initial)</a>
<a class="sourceLine" id="cb30-12" title="12">  {</a>
<a class="sourceLine" id="cb30-13" title="13">     .GlobalEnv<span class="op">$</span>pool[[i]] &lt;-<span class="st"> </span><span class="kw">makeAgent</span>(<span class="dt">psychstate=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb30-14" title="14">                           <span class="dt">biostate=</span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">6</span>),</a>
<a class="sourceLine" id="cb30-15" title="15">                            <span class="dt">p=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>naturalImmunity, naturalImmunity),<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb30-16" title="16">  }</a>
<a class="sourceLine" id="cb30-17" title="17">  </a>
<a class="sourceLine" id="cb30-18" title="18">  <span class="co">##infect patient 0</span></a>
<a class="sourceLine" id="cb30-19" title="19">  numInfected &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb30-20" title="20">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">sample</span>(numAgents_initial,numInfected))</a>
<a class="sourceLine" id="cb30-21" title="21">  {</a>
<a class="sourceLine" id="cb30-22" title="22">    <span class="cf">if</span>(infect_local){</a>
<a class="sourceLine" id="cb30-23" title="23">        </a>
<a class="sourceLine" id="cb30-24" title="24">       .GlobalEnv<span class="op">$</span>pool[[i]] &lt;-<span class="st"> </span><span class="kw">setAgentState</span>(pool[[i]],<span class="dv">2</span>) <span class="co">##infect this person</span></a>
<a class="sourceLine" id="cb30-25" title="25">       </a>
<a class="sourceLine" id="cb30-26" title="26">       </a>
<a class="sourceLine" id="cb30-27" title="27">       <span class="cf">if</span>(.GlobalEnv<span class="op">$</span>pool[[i]][<span class="st">&quot;biostate&quot;</span>] <span class="op">==</span><span class="st"> </span><span class="dv">2</span>){</a>
<a class="sourceLine" id="cb30-28" title="28">         <span class="cf">if</span>(.GlobalEnv<span class="op">$</span>pool[[i]][<span class="st">&quot;is_infected&quot;</span>] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>){         </a>
<a class="sourceLine" id="cb30-29" title="29">           local_population_infection_number &lt;-local_population_infection_number<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb30-30" title="30">          .GlobalEnv<span class="op">$</span>pool[[i]] &lt;-<span class="st"> </span><span class="kw">setAgentStatusInfected</span>( .GlobalEnv<span class="op">$</span>pool[[i]],<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb30-31" title="31">         }</a>
<a class="sourceLine" id="cb30-32" title="32">         </a>
<a class="sourceLine" id="cb30-33" title="33">       }</a>
<a class="sourceLine" id="cb30-34" title="34">    }</a>
<a class="sourceLine" id="cb30-35" title="35">    </a>
<a class="sourceLine" id="cb30-36" title="36">  } </a>
<a class="sourceLine" id="cb30-37" title="37">  </a>
<a class="sourceLine" id="cb30-38" title="38">  pool_initial &lt;&lt;-.GlobalEnv<span class="op">$</span>pool</a>
<a class="sourceLine" id="cb30-39" title="39">  local_population_infection_number &lt;&lt;-<span class="st"> </span>local_population_infection_number</a></code></pre></div>
</div>
<div id="travel-ban" class="section level2">
<h2>Travel ban</h2>
<p>In this simulation, a ‘travel ban’ is implemented from Day 7 and removed early (In this case from day 49). Each traveler will have only three connections with local agents. For this simulation, we will look at the spread of the disease through the network over time.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1">  numDays =<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb31-2" title="2">  enable_outside_travel_restriction_day &lt;-<span class="st"> </span><span class="dv">7</span></a>
<a class="sourceLine" id="cb31-3" title="3">  second_wave_day &lt;-<span class="st"> </span><span class="kw">as.integer</span>((<span class="dv">49</span><span class="op">/</span><span class="dv">100</span>)<span class="op">*</span>numDays)</a>
<a class="sourceLine" id="cb31-4" title="4">    <span class="co">#</span></a>
<a class="sourceLine" id="cb31-5" title="5"></a>
<a class="sourceLine" id="cb31-6" title="6">  <span class="co">#as.integer((numAgents_initial)*(1/100))</span></a>
<a class="sourceLine" id="cb31-7" title="7">  disthistory &lt;-<span class="st"> </span><span class="kw">travel_ban_lift</span>(enable_outside_travel_restriction_day,second_wave_day,</a>
<a class="sourceLine" id="cb31-8" title="8">                  <span class="dt">connection_number =</span> <span class="dv">3</span>,<span class="dt">will_affect_traveler =</span> <span class="dv">1</span>,<span class="dt">numDays =</span> numDays  )</a></code></pre></div>
<pre><code>## [1] &quot;TOTAL&quot;
## [1] 791
## [1] &quot;Total Local&quot;
## [1] 700
## [1] &quot;Local Death&quot;
## [1] 2
## [1] &quot;-----&quot;
## [1] &quot;Total Traveler&quot;
## [1] 91
## [1] &quot;Traveler Death&quot;
## [1] 0
## [1] &quot;Local infected at somepoint&quot;
## [1] 518
## [1] &quot;Traveler infected at somepoint&quot;
## [1] 84
## [1] &quot;Total infected at somepoint&quot;
## [1] 602</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">  disthist.df &lt;-<span class="kw">as.data.frame</span>(disthistory)</a>
<a class="sourceLine" id="cb33-2" title="2">  <span class="kw">colnames</span>(disthist.df) &lt;-<span class="st"> </span>STATENAMES</a>
<a class="sourceLine" id="cb33-3" title="3">  disthist.df<span class="op">$</span>day &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(disthistory)</a>
<a class="sourceLine" id="cb33-4" title="4">  histlong &lt;-<span class="st"> </span><span class="kw">melt</span>(disthist.df,<span class="dt">id.vars=</span><span class="st">&quot;day&quot;</span>)</a>
<a class="sourceLine" id="cb33-5" title="5"></a>
<a class="sourceLine" id="cb33-6" title="6">  <span class="kw">ggplot</span>(histlong,<span class="kw">aes</span>(<span class="dt">x=</span>day,<span class="dt">y=</span>value,<span class="dt">fill=</span>variable)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="dt">position=</span><span class="st">&quot;stack&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-7" title="7"><span class="st">    </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">  <span class="co">##make the SIR plot:</span></a>
<a class="sourceLine" id="cb34-2" title="2">  sir &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">day=</span>disthist.df<span class="op">$</span>day,</a>
<a class="sourceLine" id="cb34-3" title="3">                    <span class="dt">susceptible =</span> disthist.df<span class="op">$</span>Unexposed,</a>
<a class="sourceLine" id="cb34-4" title="4">                    <span class="dt">infected =</span> disthist.df[,<span class="dv">2</span>]<span class="op">+</span>disthist.df[,<span class="dv">3</span>],</a>
<a class="sourceLine" id="cb34-5" title="5">                    <span class="dt">recovered =</span> <span class="kw">rowSums</span>(disthist.df[,<span class="dv">4</span><span class="op">:</span><span class="dv">7</span>]))</a>
<a class="sourceLine" id="cb34-6" title="6"></a>
<a class="sourceLine" id="cb34-7" title="7">  <span class="kw">ggplot</span>(<span class="kw">melt</span>(sir,<span class="dt">id.vars=</span><span class="st">&quot;day&quot;</span>),<span class="kw">aes</span>(<span class="dt">x=</span>day,<span class="dt">group=</span>variable,<span class="dt">y=</span>value,<span class="dt">color=</span>variable)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1">  <span class="kw">ggplot</span>(histlong,<span class="kw">aes</span>(<span class="dt">x=</span>day,<span class="dt">y=</span>value,<span class="dt">group=</span>variable,<span class="dt">color=</span>variable)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<video width="960"  controls loop>
<source src="epidemic-model-travellers_files/figure-html/unnamed-chunk-9.webm" />
</video>
</div>
<div id="travel-banearly-removal" class="section level2">
<h2>Travel ban/early removal</h2>
<p>In this simulation, a ban is implemented from Day 7 and removed early (In this case from day 49). Each traveler will have only one connection with local agents</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1">  numDays =<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb36-2" title="2">  enable_outside_travel_restriction_day &lt;-<span class="st"> </span><span class="dv">7</span></a>
<a class="sourceLine" id="cb36-3" title="3">  second_wave_day &lt;-<span class="st"> </span><span class="kw">as.integer</span>((<span class="dv">49</span><span class="op">/</span><span class="dv">100</span>)<span class="op">*</span>numDays)</a>
<a class="sourceLine" id="cb36-4" title="4"></a>
<a class="sourceLine" id="cb36-5" title="5">  <span class="co">#as.integer((numAgents_initial)*(1/100))</span></a>
<a class="sourceLine" id="cb36-6" title="6">  disthistory &lt;-<span class="st"> </span><span class="kw">travel_ban_lift</span>(enable_outside_travel_restriction_day,second_wave_day,</a>
<a class="sourceLine" id="cb36-7" title="7">                  <span class="dt">connection_number =</span> <span class="dv">1</span>,<span class="dt">will_affect_traveler =</span> <span class="dv">1</span>,<span class="dt">numDays =</span> numDays  )</a></code></pre></div>
<p><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-1.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-2.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-3.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-4.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-5.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-6.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-7.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-8.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-9.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-10.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-11.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-12.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-13.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-14.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-15.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-16.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-17.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-18.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-19.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-20.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-21.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-22.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-23.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-24.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-25.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-26.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-27.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-28.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-29.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-30.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-31.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-32.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-33.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-34.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-35.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-36.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-37.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-38.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-39.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-40.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-41.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-42.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-43.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-44.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-45.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-46.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-47.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-48.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-49.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-50.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-51.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-52.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-53.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-54.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-55.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-56.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-57.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-58.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-59.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-60.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-61.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-62.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-63.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-64.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-65.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-66.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-67.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-68.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-69.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-70.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-71.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-72.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-73.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-74.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-75.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-76.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-77.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-78.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-79.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-80.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-81.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-82.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-83.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-84.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-85.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-86.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-87.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-88.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-89.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-90.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-91.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-92.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-93.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-94.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-95.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-96.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-97.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-98.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-99.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-100.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-101.png" width="960" /></p>
<pre><code>## [1] &quot;TOTAL&quot;
## [1] 791
## [1] &quot;Total Local&quot;
## [1] 700
## [1] &quot;Local Death&quot;
## [1] 0
## [1] &quot;-----&quot;
## [1] &quot;Total Traveler&quot;
## [1] 91
## [1] &quot;Traveler Death&quot;
## [1] 1
## [1] &quot;Local infected at somepoint&quot;
## [1] 541
## [1] &quot;Traveler infected at somepoint&quot;
## [1] 84
## [1] &quot;Total infected at somepoint&quot;
## [1] 625</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1">  disthist.df &lt;-<span class="kw">as.data.frame</span>(disthistory)</a>
<a class="sourceLine" id="cb38-2" title="2">  <span class="kw">colnames</span>(disthist.df) &lt;-<span class="st"> </span>STATENAMES</a>
<a class="sourceLine" id="cb38-3" title="3">  disthist.df<span class="op">$</span>day &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(disthistory)</a>
<a class="sourceLine" id="cb38-4" title="4">  histlong &lt;-<span class="st"> </span><span class="kw">melt</span>(disthist.df,<span class="dt">id.vars=</span><span class="st">&quot;day&quot;</span>)</a>
<a class="sourceLine" id="cb38-5" title="5"></a>
<a class="sourceLine" id="cb38-6" title="6">  <span class="kw">ggplot</span>(histlong,<span class="kw">aes</span>(<span class="dt">x=</span>day,<span class="dt">y=</span>value,<span class="dt">fill=</span>variable)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="dt">position=</span><span class="st">&quot;stack&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb38-7" title="7"><span class="st">    </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-102.png" width="960" /></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">  <span class="co">##make the SIR plot:</span></a>
<a class="sourceLine" id="cb39-2" title="2">  sir &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">day=</span>disthist.df<span class="op">$</span>day,</a>
<a class="sourceLine" id="cb39-3" title="3">                    <span class="dt">susceptible =</span> disthist.df<span class="op">$</span>Unexposed,</a>
<a class="sourceLine" id="cb39-4" title="4">                    <span class="dt">infected =</span> disthist.df[,<span class="dv">2</span>]<span class="op">+</span>disthist.df[,<span class="dv">3</span>],</a>
<a class="sourceLine" id="cb39-5" title="5">                    <span class="dt">recovered =</span> <span class="kw">rowSums</span>(disthist.df[,<span class="dv">4</span><span class="op">:</span><span class="dv">7</span>]))</a>
<a class="sourceLine" id="cb39-6" title="6"></a>
<a class="sourceLine" id="cb39-7" title="7">  <span class="kw">ggplot</span>(<span class="kw">melt</span>(sir,<span class="dt">id.vars=</span><span class="st">&quot;day&quot;</span>),<span class="kw">aes</span>(<span class="dt">x=</span>day,<span class="dt">group=</span>variable,<span class="dt">y=</span>value,<span class="dt">color=</span>variable)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-103.png" width="960" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1">  <span class="kw">ggplot</span>(histlong,<span class="kw">aes</span>(<span class="dt">x=</span>day,<span class="dt">y=</span>value,<span class="dt">group=</span>variable,<span class="dt">color=</span>variable)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-10-104.png" width="960" /></p>
</div>
<div id="travel-banlate-removal" class="section level2">
<h2>Travel ban/late removal</h2>
<p>In this simulation, a ban is implemented from Day 7 and removed later (In this case from day 80). Each traveler will have only three connection with local agents</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1">  <span class="co"># numDays = 250</span></a>
<a class="sourceLine" id="cb41-2" title="2">  <span class="co"># enable_outside_travel_restriction_day &lt;- 7</span></a>
<a class="sourceLine" id="cb41-3" title="3">  <span class="co"># second_wave_day &lt;- as.integer((80/100)*numDays)</span></a>
<a class="sourceLine" id="cb41-4" title="4">  <span class="co"># </span></a>
<a class="sourceLine" id="cb41-5" title="5">  <span class="co"># #as.integer((numAgents_initial)*(1/100))</span></a>
<a class="sourceLine" id="cb41-6" title="6">  <span class="co"># disthistory &lt;- travel_ban_lift(enable_outside_travel_restriction_day,second_wave_day,</span></a>
<a class="sourceLine" id="cb41-7" title="7">  <span class="co">#                 connection_number = 3,will_affect_traveler = 1,numDays = numDays  )</span></a>
<a class="sourceLine" id="cb41-8" title="8">  <span class="co">#   </span></a>
<a class="sourceLine" id="cb41-9" title="9">  <span class="co"># disthist.df &lt;-as.data.frame(disthistory)</span></a>
<a class="sourceLine" id="cb41-10" title="10">  <span class="co"># colnames(disthist.df) &lt;- STATENAMES</span></a>
<a class="sourceLine" id="cb41-11" title="11">  <span class="co"># disthist.df$day &lt;- 1:nrow(disthistory)</span></a>
<a class="sourceLine" id="cb41-12" title="12">  <span class="co"># histlong &lt;- melt(disthist.df,id.vars=&quot;day&quot;)</span></a>
<a class="sourceLine" id="cb41-13" title="13">  <span class="co"># </span></a>
<a class="sourceLine" id="cb41-14" title="14">  <span class="co"># ggplot(histlong,aes(x=day,y=value,fill=variable)) + geom_bar(stat=&quot;identity&quot;,position=&quot;stack&quot;) + </span></a>
<a class="sourceLine" id="cb41-15" title="15">  <span class="co">#   theme_bw()</span></a>
<a class="sourceLine" id="cb41-16" title="16">  <span class="co"># </span></a>
<a class="sourceLine" id="cb41-17" title="17">  <span class="co"># ##make the SIR plot:</span></a>
<a class="sourceLine" id="cb41-18" title="18">  <span class="co"># sir &lt;- data.frame(day=disthist.df$day,</span></a>
<a class="sourceLine" id="cb41-19" title="19">  <span class="co">#                   susceptible = disthist.df$Unexposed,</span></a>
<a class="sourceLine" id="cb41-20" title="20">  <span class="co">#                   infected = disthist.df[,2]+disthist.df[,3],</span></a>
<a class="sourceLine" id="cb41-21" title="21">  <span class="co">#                   recovered = rowSums(disthist.df[,4:7]))</span></a>
<a class="sourceLine" id="cb41-22" title="22">  <span class="co"># </span></a>
<a class="sourceLine" id="cb41-23" title="23">  <span class="co"># ggplot(melt(sir,id.vars=&quot;day&quot;),aes(x=day,group=variable,y=value,color=variable)) + geom_line(size = 2) + theme_bw()</span></a>
<a class="sourceLine" id="cb41-24" title="24">  <span class="co"># ggplot(histlong,aes(x=day,y=value,group=variable,color=variable)) + geom_line(size = 2) + theme_bw()</span></a></code></pre></div>
</div>
<div id="second-simulation-series" class="section level2">
<h2>Second simulation series</h2>
<p>In this series of simulations, some locals are affected with a strain from beginning, and travellers will augment this by bringing the disease in from outside.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">  numAgents_initial &lt;&lt;-<span class="st"> </span><span class="dv">700</span></a>
<a class="sourceLine" id="cb42-2" title="2">  naturalImmunity &lt;-<span class="st"> </span><span class="fl">.01</span></a>
<a class="sourceLine" id="cb42-3" title="3">  socialnetwork &lt;-<span class="kw">makeNetwork</span>(numAgents_initial,<span class="dt">numsets=</span><span class="dv">1</span>,<span class="dt">power=</span>.<span class="dv">5</span>,<span class="dt">steps=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb42-4" title="4">  local_population_infection_number &lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb42-5" title="5">  </a>
<a class="sourceLine" id="cb42-6" title="6">  infect_local &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb42-7" title="7">  </a>
<a class="sourceLine" id="cb42-8" title="8">  original_network_of_agents &lt;&lt;-<span class="st"> </span>socialnetwork</a>
<a class="sourceLine" id="cb42-9" title="9">  </a>
<a class="sourceLine" id="cb42-10" title="10">  .GlobalEnv<span class="op">$</span>pool &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb42-11" title="11">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>numAgents_initial)</a>
<a class="sourceLine" id="cb42-12" title="12">  {</a>
<a class="sourceLine" id="cb42-13" title="13">     .GlobalEnv<span class="op">$</span>pool[[i]] &lt;-<span class="st"> </span><span class="kw">makeAgent</span>(<span class="dt">psychstate=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb42-14" title="14">                           <span class="dt">biostate=</span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">6</span>),</a>
<a class="sourceLine" id="cb42-15" title="15">                            <span class="dt">p=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>naturalImmunity, naturalImmunity),<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb42-16" title="16">  }</a>
<a class="sourceLine" id="cb42-17" title="17">  </a>
<a class="sourceLine" id="cb42-18" title="18">  <span class="co">##infect patient 0</span></a>
<a class="sourceLine" id="cb42-19" title="19">  numInfected &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb42-20" title="20">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">sample</span>(numAgents_initial,numInfected))</a>
<a class="sourceLine" id="cb42-21" title="21">  {</a>
<a class="sourceLine" id="cb42-22" title="22">    <span class="cf">if</span>(infect_local){</a>
<a class="sourceLine" id="cb42-23" title="23">        </a>
<a class="sourceLine" id="cb42-24" title="24">       .GlobalEnv<span class="op">$</span>pool[[i]] &lt;-<span class="st"> </span><span class="kw">setAgentState</span>(pool[[i]],<span class="dv">2</span>) <span class="co">##infect this person</span></a>
<a class="sourceLine" id="cb42-25" title="25">       </a>
<a class="sourceLine" id="cb42-26" title="26">       </a>
<a class="sourceLine" id="cb42-27" title="27">       <span class="cf">if</span>(.GlobalEnv<span class="op">$</span>pool[[i]][<span class="st">&quot;biostate&quot;</span>] <span class="op">==</span><span class="st"> </span><span class="dv">2</span>){</a>
<a class="sourceLine" id="cb42-28" title="28">         <span class="cf">if</span>(.GlobalEnv<span class="op">$</span>pool[[i]][<span class="st">&quot;is_infected&quot;</span>] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>){         </a>
<a class="sourceLine" id="cb42-29" title="29">           local_population_infection_number &lt;-local_population_infection_number<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb42-30" title="30">          .GlobalEnv<span class="op">$</span>pool[[i]] &lt;-<span class="st"> </span><span class="kw">setAgentStatusInfected</span>( .GlobalEnv<span class="op">$</span>pool[[i]],<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb42-31" title="31">         }</a>
<a class="sourceLine" id="cb42-32" title="32">         </a>
<a class="sourceLine" id="cb42-33" title="33">       }</a>
<a class="sourceLine" id="cb42-34" title="34">    }</a>
<a class="sourceLine" id="cb42-35" title="35">    </a>
<a class="sourceLine" id="cb42-36" title="36">  } </a>
<a class="sourceLine" id="cb42-37" title="37">  </a>
<a class="sourceLine" id="cb42-38" title="38">  pool_initial &lt;&lt;-.GlobalEnv<span class="op">$</span>pool</a>
<a class="sourceLine" id="cb42-39" title="39">  local_population_infection_number &lt;&lt;-<span class="st"> </span>local_population_infection_number</a></code></pre></div>
</div>
<div id="if-no-traveler-is-allowed-and-some-locals-are-infected" class="section level2">
<h2>IF no traveler is allowed and some locals are infected</h2>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1">  <span class="co"># numDays = 100</span></a>
<a class="sourceLine" id="cb43-2" title="2">  <span class="co"># enable_outside_travel_restriction_day &lt;- 1</span></a>
<a class="sourceLine" id="cb43-3" title="3">  <span class="co"># second_wave_day &lt;- 101</span></a>
<a class="sourceLine" id="cb43-4" title="4">  <span class="co"># </span></a>
<a class="sourceLine" id="cb43-5" title="5">  <span class="co"># #as.integer((numAgents_initial)*(1/100))</span></a>
<a class="sourceLine" id="cb43-6" title="6">  <span class="co"># disthistory &lt;- travel_ban_lift(enable_outside_travel_restriction_day,second_wave_day,</span></a>
<a class="sourceLine" id="cb43-7" title="7">  <span class="co">#                 connection_number = 3,will_affect_traveler = 1,numDays = numDays,people_leave_status = 0  )</span></a>
<a class="sourceLine" id="cb43-8" title="8">  <span class="co">#   </span></a>
<a class="sourceLine" id="cb43-9" title="9">  <span class="co"># disthist.df &lt;-as.data.frame(disthistory)</span></a>
<a class="sourceLine" id="cb43-10" title="10">  <span class="co"># colnames(disthist.df) &lt;- STATENAMES</span></a>
<a class="sourceLine" id="cb43-11" title="11">  <span class="co"># disthist.df$day &lt;- 1:nrow(disthistory)</span></a>
<a class="sourceLine" id="cb43-12" title="12">  <span class="co"># histlong &lt;- melt(disthist.df,id.vars=&quot;day&quot;)</span></a>
<a class="sourceLine" id="cb43-13" title="13">  <span class="co"># </span></a>
<a class="sourceLine" id="cb43-14" title="14">  <span class="co"># ggplot(histlong,aes(x=day,y=value,fill=variable)) + geom_bar(stat=&quot;identity&quot;,position=&quot;stack&quot;) + </span></a>
<a class="sourceLine" id="cb43-15" title="15">  <span class="co">#   theme_bw()</span></a>
<a class="sourceLine" id="cb43-16" title="16">  <span class="co"># </span></a>
<a class="sourceLine" id="cb43-17" title="17">  <span class="co"># ##make the SIR plot:</span></a>
<a class="sourceLine" id="cb43-18" title="18">  <span class="co"># sir &lt;- data.frame(day=disthist.df$day,</span></a>
<a class="sourceLine" id="cb43-19" title="19">  <span class="co">#                   susceptible = disthist.df$Unexposed,</span></a>
<a class="sourceLine" id="cb43-20" title="20">  <span class="co">#                   infected = disthist.df[,2]+disthist.df[,3],</span></a>
<a class="sourceLine" id="cb43-21" title="21">  <span class="co">#                   recovered = rowSums(disthist.df[,4:7]))</span></a>
<a class="sourceLine" id="cb43-22" title="22">  <span class="co"># </span></a>
<a class="sourceLine" id="cb43-23" title="23">  <span class="co"># ggplot(melt(sir,id.vars=&quot;day&quot;),aes(x=day,group=variable,y=value,color=variable)) + geom_line(size=2) + theme_bw()</span></a>
<a class="sourceLine" id="cb43-24" title="24">  <span class="co"># ggplot(histlong,aes(x=day,y=value,group=variable,color=variable)) + geom_line(size=2) + theme_bw()</span></a></code></pre></div>
</div>
<div id="travel-ban-removed-early" class="section level2">
<h2>Travel ban removed early</h2>
<p>In this simulation, a travel ban is implemented from Day 7 and removed early (In this case from day 49). Each traveler will have only three connections with local agents</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1">  numDays =<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb44-2" title="2">  enable_outside_travel_restriction_day &lt;-<span class="st"> </span><span class="dv">7</span></a>
<a class="sourceLine" id="cb44-3" title="3">  second_wave_day &lt;-<span class="st"> </span><span class="kw">as.integer</span>((<span class="dv">49</span><span class="op">/</span><span class="dv">100</span>)<span class="op">*</span>numDays)</a>
<a class="sourceLine" id="cb44-4" title="4">  </a>
<a class="sourceLine" id="cb44-5" title="5">  <span class="co">#as.integer((numAgents_initial)*(1/100))</span></a>
<a class="sourceLine" id="cb44-6" title="6">  disthistory &lt;-<span class="st"> </span><span class="kw">travel_ban_lift</span>(enable_outside_travel_restriction_day,second_wave_day,</a>
<a class="sourceLine" id="cb44-7" title="7">                  <span class="dt">connection_number =</span> <span class="dv">3</span>,<span class="dt">will_affect_traveler =</span> <span class="dv">1</span>,<span class="dt">numDays =</span> numDays  )</a></code></pre></div>
<p><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-1.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-2.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-3.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-4.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-5.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-6.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-7.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-8.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-9.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-10.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-11.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-12.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-13.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-14.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-15.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-16.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-17.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-18.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-19.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-20.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-21.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-22.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-23.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-24.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-25.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-26.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-27.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-28.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-29.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-30.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-31.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-32.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-33.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-34.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-35.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-36.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-37.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-38.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-39.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-40.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-41.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-42.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-43.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-44.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-45.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-46.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-47.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-48.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-49.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-50.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-51.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-52.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-53.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-54.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-55.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-56.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-57.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-58.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-59.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-60.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-61.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-62.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-63.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-64.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-65.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-66.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-67.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-68.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-69.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-70.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-71.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-72.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-73.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-74.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-75.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-76.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-77.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-78.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-79.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-80.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-81.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-82.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-83.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-84.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-85.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-86.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-87.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-88.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-89.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-90.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-91.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-92.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-93.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-94.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-95.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-96.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-97.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-98.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-99.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-100.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-101.png" width="960" /></p>
<pre><code>## [1] &quot;TOTAL&quot;
## [1] 791
## [1] &quot;Total Local&quot;
## [1] 700
## [1] &quot;Local Death&quot;
## [1] 2
## [1] &quot;-----&quot;
## [1] &quot;Total Traveler&quot;
## [1] 91
## [1] &quot;Traveler Death&quot;
## [1] 0
## [1] &quot;Local infected at somepoint&quot;
## [1] 468
## [1] &quot;Traveler infected at somepoint&quot;
## [1] 84
## [1] &quot;Total infected at somepoint&quot;
## [1] 552</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1">  disthist.df &lt;-<span class="kw">as.data.frame</span>(disthistory)</a>
<a class="sourceLine" id="cb46-2" title="2">  <span class="kw">colnames</span>(disthist.df) &lt;-<span class="st"> </span>STATENAMES</a>
<a class="sourceLine" id="cb46-3" title="3">  disthist.df<span class="op">$</span>day &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(disthistory)</a>
<a class="sourceLine" id="cb46-4" title="4">  histlong &lt;-<span class="st"> </span><span class="kw">melt</span>(disthist.df,<span class="dt">id.vars=</span><span class="st">&quot;day&quot;</span>)</a>
<a class="sourceLine" id="cb46-5" title="5">  </a>
<a class="sourceLine" id="cb46-6" title="6">  <span class="kw">ggplot</span>(histlong,<span class="kw">aes</span>(<span class="dt">x=</span>day,<span class="dt">y=</span>value,<span class="dt">fill=</span>variable)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="dt">position=</span><span class="st">&quot;stack&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb46-7" title="7"><span class="st">    </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-102.png" width="960" /></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1">  <span class="co">##make the SIR plot:</span></a>
<a class="sourceLine" id="cb47-2" title="2">  sir &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">day=</span>disthist.df<span class="op">$</span>day,</a>
<a class="sourceLine" id="cb47-3" title="3">                    <span class="dt">susceptible =</span> disthist.df<span class="op">$</span>Unexposed,</a>
<a class="sourceLine" id="cb47-4" title="4">                    <span class="dt">infected =</span> disthist.df[,<span class="dv">2</span>]<span class="op">+</span>disthist.df[,<span class="dv">3</span>],</a>
<a class="sourceLine" id="cb47-5" title="5">                    <span class="dt">recovered =</span> <span class="kw">rowSums</span>(disthist.df[,<span class="dv">4</span><span class="op">:</span><span class="dv">7</span>]))</a>
<a class="sourceLine" id="cb47-6" title="6">  </a>
<a class="sourceLine" id="cb47-7" title="7">  <span class="kw">ggplot</span>(<span class="kw">melt</span>(sir,<span class="dt">id.vars=</span><span class="st">&quot;day&quot;</span>),<span class="kw">aes</span>(<span class="dt">x=</span>day,<span class="dt">group=</span>variable,<span class="dt">y=</span>value,<span class="dt">color=</span>variable)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-103.png" width="960" /></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1">  <span class="kw">ggplot</span>(histlong,<span class="kw">aes</span>(<span class="dt">x=</span>day,<span class="dt">y=</span>value,<span class="dt">group=</span>variable,<span class="dt">color=</span>variable)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-14-104.png" width="960" /></p>
</div>
<div id="travel-banremoved-late" class="section level2">
<h2>Travel ban/removed late</h2>
<p>In this simulation, a ban is implemented from Day 7 and removed later. Each traveler will have only three connection with local agents</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1">  numDays =<span class="st"> </span><span class="dv">250</span></a>
<a class="sourceLine" id="cb49-2" title="2">  enable_outside_travel_restriction_day &lt;-<span class="st"> </span><span class="dv">7</span></a>
<a class="sourceLine" id="cb49-3" title="3">  second_wave_day &lt;-<span class="st"> </span><span class="kw">as.integer</span>((<span class="dv">80</span><span class="op">/</span><span class="dv">100</span>)<span class="op">*</span>numDays)</a>
<a class="sourceLine" id="cb49-4" title="4">  </a>
<a class="sourceLine" id="cb49-5" title="5">  <span class="co">#as.integer((numAgents_initial)*(1/100))</span></a>
<a class="sourceLine" id="cb49-6" title="6">  disthistory &lt;-<span class="st"> </span><span class="kw">travel_ban_lift</span>(enable_outside_travel_restriction_day,second_wave_day,</a>
<a class="sourceLine" id="cb49-7" title="7">                  <span class="dt">connection_number =</span> <span class="dv">3</span>,<span class="dt">will_affect_traveler =</span> <span class="dv">1</span>,<span class="dt">numDays =</span> numDays  )</a></code></pre></div>
<p><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-1.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-2.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-3.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-4.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-5.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-6.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-7.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-8.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-9.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-10.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-11.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-12.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-13.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-14.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-15.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-16.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-17.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-18.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-19.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-20.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-21.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-22.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-23.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-24.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-25.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-26.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-27.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-28.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-29.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-30.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-31.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-32.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-33.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-34.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-35.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-36.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-37.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-38.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-39.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-40.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-41.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-42.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-43.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-44.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-45.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-46.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-47.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-48.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-49.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-50.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-51.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-52.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-53.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-54.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-55.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-56.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-57.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-58.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-59.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-60.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-61.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-62.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-63.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-64.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-65.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-66.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-67.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-68.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-69.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-70.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-71.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-72.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-73.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-74.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-75.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-76.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-77.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-78.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-79.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-80.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-81.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-82.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-83.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-84.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-85.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-86.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-87.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-88.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-89.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-90.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-91.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-92.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-93.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-94.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-95.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-96.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-97.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-98.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-99.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-100.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-101.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-102.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-103.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-104.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-105.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-106.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-107.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-108.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-109.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-110.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-111.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-112.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-113.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-114.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-115.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-116.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-117.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-118.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-119.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-120.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-121.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-122.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-123.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-124.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-125.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-126.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-127.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-128.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-129.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-130.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-131.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-132.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-133.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-134.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-135.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-136.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-137.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-138.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-139.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-140.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-141.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-142.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-143.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-144.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-145.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-146.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-147.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-148.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-149.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-150.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-151.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-152.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-153.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-154.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-155.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-156.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-157.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-158.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-159.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-160.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-161.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-162.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-163.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-164.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-165.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-166.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-167.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-168.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-169.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-170.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-171.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-172.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-173.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-174.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-175.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-176.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-177.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-178.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-179.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-180.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-181.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-182.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-183.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-184.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-185.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-186.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-187.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-188.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-189.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-190.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-191.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-192.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-193.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-194.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-195.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-196.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-197.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-198.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-199.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-200.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-201.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-202.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-203.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-204.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-205.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-206.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-207.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-208.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-209.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-210.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-211.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-212.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-213.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-214.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-215.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-216.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-217.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-218.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-219.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-220.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-221.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-222.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-223.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-224.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-225.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-226.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-227.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-228.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-229.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-230.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-231.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-232.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-233.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-234.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-235.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-236.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-237.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-238.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-239.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-240.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-241.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-242.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-243.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-244.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-245.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-246.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-247.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-248.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-249.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-250.png" width="960" /><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-251.png" width="960" /></p>
<pre><code>## [1] &quot;TOTAL&quot;
## [1] 784
## [1] &quot;Total Local&quot;
## [1] 700
## [1] &quot;Local Death&quot;
## [1] 3
## [1] &quot;-----&quot;
## [1] &quot;Total Traveler&quot;
## [1] 84
## [1] &quot;Traveler Death&quot;
## [1] 1
## [1] &quot;Local infected at somepoint&quot;
## [1] 487
## [1] &quot;Traveler infected at somepoint&quot;
## [1] 77
## [1] &quot;Total infected at somepoint&quot;
## [1] 564</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1">  disthist.df &lt;-<span class="kw">as.data.frame</span>(disthistory)</a>
<a class="sourceLine" id="cb51-2" title="2">  <span class="kw">colnames</span>(disthist.df) &lt;-<span class="st"> </span>STATENAMES</a>
<a class="sourceLine" id="cb51-3" title="3">  disthist.df<span class="op">$</span>day &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(disthistory)</a>
<a class="sourceLine" id="cb51-4" title="4">  histlong &lt;-<span class="st"> </span><span class="kw">melt</span>(disthist.df,<span class="dt">id.vars=</span><span class="st">&quot;day&quot;</span>)</a>
<a class="sourceLine" id="cb51-5" title="5">  </a>
<a class="sourceLine" id="cb51-6" title="6">  <span class="kw">ggplot</span>(histlong,<span class="kw">aes</span>(<span class="dt">x=</span>day,<span class="dt">y=</span>value,<span class="dt">fill=</span>variable)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="dt">position=</span><span class="st">&quot;stack&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb51-7" title="7"><span class="st">    </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-252.png" width="960" /></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1">  <span class="co">##make the SIR plot:</span></a>
<a class="sourceLine" id="cb52-2" title="2">  sir &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">day=</span>disthist.df<span class="op">$</span>day,</a>
<a class="sourceLine" id="cb52-3" title="3">                    <span class="dt">susceptible =</span> disthist.df<span class="op">$</span>Unexposed,</a>
<a class="sourceLine" id="cb52-4" title="4">                    <span class="dt">infected =</span> disthist.df[,<span class="dv">2</span>]<span class="op">+</span>disthist.df[,<span class="dv">3</span>],</a>
<a class="sourceLine" id="cb52-5" title="5">                    <span class="dt">recovered =</span> <span class="kw">rowSums</span>(disthist.df[,<span class="dv">4</span><span class="op">:</span><span class="dv">7</span>]))</a>
<a class="sourceLine" id="cb52-6" title="6">  </a>
<a class="sourceLine" id="cb52-7" title="7">  <span class="kw">ggplot</span>(<span class="kw">melt</span>(sir,<span class="dt">id.vars=</span><span class="st">&quot;day&quot;</span>),<span class="kw">aes</span>(<span class="dt">x=</span>day,<span class="dt">group=</span>variable,<span class="dt">y=</span>value,<span class="dt">color=</span>variable)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-253.png" width="960" /></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1">  <span class="kw">ggplot</span>(histlong,<span class="kw">aes</span>(<span class="dt">x=</span>day,<span class="dt">y=</span>value,<span class="dt">group=</span>variable,<span class="dt">color=</span>variable)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="epidemic-model-travellers_files/figure-html/unnamed-chunk-15-254.png" width="960" /></p>
</div>
</div>
</div>


</div>




<script>
$(document).ready(function () {
 	  });
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
